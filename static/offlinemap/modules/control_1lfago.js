/**/﻿_jsload&&_jsload('control', 'e9.extend(gn.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){gZ.prototype.initialize.call(this,e);this._render();this._updateState();this._bind(e);return this._container},_bind:function(i){var e=this;i.addEventListener("load",function(T){e._updateState()});i.addEventListener("moveend",function(T){e._updateState()});i.addEventListener("zoomend",function(T){e._updateState()})},_render:function(){gZ.prototype._render.call(this);e9.ac(this._container,"BMap_cpyCtrl");var e=this._container.style;e.cursor="default";e.whiteSpace="nowrap";e.MozUserSelect="none";e.WebkitTextSizeAdjust="none";gZ.prototype._setPosition.call(this);if(this.sateMapStyle){this.addSateMapStyle()}},_updateState:function(){if(!this._map||!this._container||this._copyrightCollection.length===0){return}for(var kC=0,e=this._copyrightCollection.length;kC<e;kC++){var kE;var kG=this._map.getZoom();if(this._copyrightCollection[kC].mapType!==""&&this._map.mapType!==this._copyrightCollection[kC].mapType){kE=false}else{if(kG<this._copyrightCollection[kC].minZoom){kE=false}else{kE=true}}if(kE){if(this._container){var kD=false;for(var T=0,kF=this._container.children.length;T<kF;T++){if(parseInt(this._container.children[T].getAttribute("_cid"),10)===this._copyrightCollection[kC].id){kD=true;this._container.children[T].style.display="block";if(this._container.children[T].innerHTML!==this._copyrightCollection[kC].content){this._container.children[T].innerHTML=this._copyrightCollection[kC].content}break}}if(!kD){this._generateHTML(this._copyrightCollection[kC])}}}else{if(this._container){for(var T=0;T<this._container.children.length;T++){if(parseInt(this._container.children[T].getAttribute("_cid"),10)===this._copyrightCollection[kC].id&&this._container.children[T].style.display!=="none"){this._container.children[T].style.display="none";return}}}}}},addCopyright:function(kC){if(!kC||typeof kC.id!=="number"||isNaN(kC.id)){return}var e={minZoom:0,bounds:null,content:"",mapType:""};for(var T in kC){e[T]=kC[T]}if(this._map){var kF=e.minZoom;if(kF===-1||kF<this._map.getMinZoom()||kF>this._map.getMaxZoom()){e.minZoom=this._map.getMinZoom()}if(e.mapType!==""&&!ev[e.mapType]){e.mapType=BMAPGL_NORMAL_MAP}}var kD=this.getCopyright(kC.id);if(kD){for(var kE in e){kD[kE]=e[kE]}}else{this._copyrightCollection.push(e)}this._updateState()},getCopyright:function(kC){for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===kC){return this._copyrightCollection[T]}}},getCopyrightCollection:function(){return this._copyrightCollection},removeCopyright:function(kE){var kC;for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===kE){kC=this._copyrightCollection.splice(T,1);T--;e=this._copyrightCollection.length}}var kD=this.getDom(kE);if(kD&&kD.parentNode){kD.parentNode.removeChild(kD);kD=null}this._updateState();return kC},_generateHTML:function(e){if(!this._container){return}this._container.innerHTML+=\'<span _cid="\'+e.id+\'">\'+e.content+"</span>"},getDom:function(kD){var kC=gZ.prototype.getDom.call(this);if(typeof kD==="undefined"){return kC}else{if(kC){for(var T=0,e=kC.children.length;T<e;T++){if(parseInt(kC.children[T].getAttribute("_cid"),10)===kD){return kC.children[T]}}}}}});function fM(){}e9.extend(j6.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map);this.dispatchEvent(new fW("ondomready"))}},initialize:function(e){gZ.prototype.initialize.call(this,e);this._firstAnimation=true;this._setParam();this._render();this._bind();this._setSliderZoomLv(e.getZoom());this._bindMapEvent(e);var i=this._opts.offset||(new jo(1,0));this.setOffset(i);this.redraw();return this._container},_bindMapEvent:function(i){var e=this;i.addEventListener("zoomend",function(T){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom());if(e._msover){return}if(e._isShowLevelHint){if(e.getType()===BMAP_NAVIGATION_CONTROL_ANIM){e._hideTimerId=setTimeout(function(){e._hideLevelHint(true);e._shrinkSlider()},1000)}else{e._hideTimerId=setTimeout(function(){e._hideLevelHint(true)},1000)}}});i.addEventListener("mousewheel",function(){if(!e._map){return}if(e._map.config.enableWheelZoom&&e._isShowLevelHint){if(e._hideTimerId){clearTimeout(e._hideTimerId);e._hideTimerId=null}if(e.getType()!==BMAP_NAVIGATION_CONTROL_ANIM){e._showLevelHint()}}});i.addEventListener("load",function(T){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom())})},redraw:function(){this._setParam();this.setType(this._opts.type);if(this._map){this._setSliderZoomLv(this._map.getZoom())}},_setParam:function(){this._minZoomLevel=this._map.config.zoomLevelMin;this._maxZoomLevel=this._map.config.zoomLevelMax;if(this._minZoomLevel>4||this._maxZoomLevel<18){this._isShowLevelHint=false}else{this._isShowLevelHint=true}this._totalZoomLv=this._maxZoomLevel-this._minZoomLevel+1;this._maxBarY=this._minBarY+(this._totalZoomLv-1)*this._sliderInterval},_render:function(){gZ.prototype._render.call(this);var T=e9.Browser.ie==6?" BMap_ie6":"";var i=" BMap_stdMpType"+this._opts.type;var kC=this._container;e9.ac(kC,"BMap_stdMpCtrl");e9.ac(kC,T);e9.ac(kC,i);kC.innerHTML=this._generateHtml(this._opts.type);this._setSliderBarCursor(e9.Browser.opera?"pointer":E.defaultCursor);this._panBtnContainer=e9.G(kC.children[0]);this._zoomDom=e9.G(kC.children[1]);var e=this._zoomDom;this._btnZoomIn=e9.G(e.children[0]);this._btnZoomOut=e9.G(e.children[1]);this._sliderDom=e9.G(e.children[2]);this._sliderBaseDom=e9.G(e.children[2].children[0]);this._sliderBotDom=e9.G(e.children[2].children[1]);this.setType(this._opts.type)},_setSliderHeight:function(){var i=this._opts.type;var kC=this.controlHeight[i].width;var kD=this.controlHeight[i].height;var kE=this.controlHeight[i].zoomHeight;var e=this.controlHeight[i].zoomWidth;var kF=this.controlHeight[i].sliderHeight;if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){}this._container.style.width=kC+"px";this._container.style.height=kD+"px";this._zoomDom.style.height=kE+"px";this._zoomDom.style.width=kC+"px";if(this.getType()==BMAP_NAVIGATION_CONTROL_ANIM){this._btnZoomOut.style.top=24+"px"}else{var T=(this._opts.forceNew===true)?29:23;this._btnZoomOut.style.top=kE-T+"px"}this._sliderDom.style.height=kF+"px";this._sliderBaseDom.style.height=kF+"px";if(this._opts.type==BMAP_NAVIGATION_CONTROL_ZOOM){this._zoomDom.children[0].style.left=this._zoomDom.children[1].style.left="0"}else{this._zoomDom.children[0].style.left=this._zoomDom.children[1].style.left=""}},_generateHtml:function(){var e=[];e.push(this._generatePanHtml());e.push(this._generateZoomContainerHtml());return e.join("")},_generatePanHtml:function(){var e=\'<div class="BMap_stdMpPan"><div class="BMap_button BMap_panN" title="向上平移"></div><div class="BMap_button BMap_panW" title="向左平移"></div><div class="BMap_button BMap_panE" title="向右平移"></div><div class="BMap_button BMap_panS" title="向下平移"></div><div class="BMap_stdMpPanBg BMap_smcbg"></div></div>\';return e},_generateZoomContainerHtml:function(){var e=\'<div class="BMap_stdMpZoom">\'+this._generateZoomHtml()+this._generateSliderHtml()+this._generateZoomBalloonHtml()+"</div>";return e},_generateZoomHtml:function(){var e="BMap_button";(this._opts.forceNew===true)&&(e="BMap_button_new");var i=\'<div class="\'+e+\' BMap_stdMpZoomIn" title="放大一级"><div class="BMap_smcbg in"></div></div><div class="\'+e+\' BMap_stdMpZoomOut" title="缩小一级"><div class="BMap_smcbg out"></div></div>\';return i},_generateSliderHtml:function(){var e=\'<div class="BMap_stdMpSlider"><div class="BMap_stdMpSliderBgTop"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderBgBot"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderMask" title="放置到此级别"></div><div class="BMap_stdMpSliderBar" title="拖动缩放"><div class="BMap_smcbg"></div></div></div>\';return e},_generateZoomBalloonHtml:function(){var e=\'<div class="BMap_zlHolder"><div class="BMap_zlSt"><div class="BMap_smcbg"></div></div><div class="BMap_zlCity"><div class="BMap_smcbg"></div></div><div class="BMap_zlProv"><div class="BMap_smcbg"></div></div><div class="BMap_zlCountry"><div class="BMap_smcbg"></div></div></div>\';return e},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ANIM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}if(!this._map||!this._container){return}var i=this._container;i.className=i.className.replace(/BMap_stdMpType\\d/,"BMap_stdMpType"+this._opts.type);this._setSliderHeight();if(e!=BMAP_NAVIGATION_CONTROL_LARGE&&e!=BMAP_NAVIGATION_CONTROL_ANIM){e9.rc(i.children[1].children[2],"hvr")}this.setAnchor(this._opts.anchor)},getType:function(){return this._opts.type},_bind:function(){var kM=this;var kL=kM._container;var kE=this._opts.from=="MAP_INDEX";function kD(i,kO){return i.contains?i!=kO&&i.contains(kO):!!(i.compareDocumentPosition(kO)&16)}function kH(kQ,kP){var kO,i=kQ.type.toLowerCase();if(i=="mouseover"){kO=kQ.relatedTarget||kQ.fromElement}else{if(i==="mouseout"){kO=kQ.relatedTarget||kQ.toElement}else{return true}}return kO&&kO.prefix!="xul"&&!kD(kP,kO)&&kO!==kP}e9.on(kL,"mouseover",function(i){i=i||window.event;if(kH(i,kL)){kM.dispatchEvent(new fW("onmouseover"))}});e9.on(kL,"mouseout",function(i){i=i||window.event;if(kH(i,kL)){kM.dispatchEvent(new fW("onmouseout"))}});function kC(){if(!kM._isShowLevelHint){return}kM._msover=true;if(kM._hideTimerId){clearTimeout(kM._hideTimerId);kM._hideTimerId=null}kM._expandSlider();if(kM.getType()!==BMAP_NAVIGATION_CONTROL_ANIM){kM._showLevelHint()}}function kG(){if(!kM._isShowLevelHint){return}if(kM._hideTimerId){clearTimeout(kM._hideTimerId)}kM._msover=false;kM._hideTimerId=setTimeout(function(){kM._hideLevelHint();kM._hideTimerId=null;kM._shrinkSlider()},1000)}if("onmouseenter" in document.documentElement){e9.on(this._zoomDom,"mouseenter",function(i){kC()});e9.on(this._zoomDom,"mouseleave",function(kO){var i=kO.relatedTarget;if(i&&(i===this||kD(this,i))){return}kG()})}else{e9.on(this._zoomDom,"mouseover",function(kO){var i=kO.relatedTarget;if(i&&(i===this||kD(this,i))){return}kC()});e9.on(this._zoomDom,"mouseout",function(kO){var i=kO.relatedTarget;if(i&&(i===this||kD(this,i))){return}kG()})}e9.on(kL.children[0],"mouseover",function(){kM._hideLevelHint(true)});e9.on(kL.children[0].children[0],"click",function(){kM._panBy(0,Math.round(kM._map.height/3));kE?fM(6004):null});e9.on(kL.children[0].children[1],"click",function(){kM._panBy(Math.round(kM._map.width/3),0);kE?fM(6004):null});e9.on(kL.children[0].children[2],"click",function(){kM._panBy(-Math.round(kM._map.width/3),0);kE?fM(6004):null});e9.on(kL.children[0].children[3],"click",function(){kM._panBy(0,-Math.round(kM._map.height/3));kE?fM(6004):null});e9.on(kL.children[0].children[0],"mouseover",function(){kM._panBtnContainer.style.backgroundPosition="0 -44px"});e9.on(kL.children[0].children[1],"mouseover",function(){kM._panBtnContainer.style.backgroundPosition="0 -176px"});e9.on(kL.children[0].children[2],"mouseover",function(){kM._panBtnContainer.style.backgroundPosition="0 -88px"});e9.on(kL.children[0].children[3],"mouseover",function(){kM._panBtnContainer.style.backgroundPosition="0 -132px"});e9.on(kM._panBtnContainer,"mouseout",function(){kM._panBtnContainer.style.backgroundPosition="0 0"});var kK=kL.children[1].children;e9.on(kK[0],"click",function(){var i=kM._map;if(i.mapType===BMAP_EARTH_MAP){if(i._earth){if(i._earth.getLock()){return}i._earth.zoomIn({from:"control"});i._earth.fire(new fW("onzoominclick"))}}else{kE?fM(6005):null;if(i.config.isModernBrowser){kM._deepZoomIn()}else{kM._zoomIn()}i.fire(new fW("onzoominclick"))}});e9.on(kK[1],"click",function(){var i=kM._map;if(i.mapType===BMAP_EARTH_MAP){if(i._earth){if(i._earth.getLock()){return}i._earth.zoomOut({from:"control"});i._earth.fire(new fW("onzoomoutclick"))}}else{kE?fM(6005):null;if(i.config.isModernBrowser){kM._deepZoomOut()}else{kM._zoomOut()}i.fire(new fW("onzoomoutclick"))}});for(var kF=1;kF<6;kF++){e9.on(kL.children[0].children[kF],"mouseup",function(i){if(kM._map.currentOperation!==ep.dragging&&kM._map.currentOperation!==ep.stdMapCtrlDrag){al(i)}});e9.on(kL.children[0].children[kF],"contextmenu",function(i){d(i)});e9.on(kL.children[0].children[kF],"click",function(i){d(i)})}e9.on(kK[0],"mouseup",function(i){if(kM._map.currentOperation!==ep.dragging&&kM._map.currentOperation!==ep.stdMapCtrlDrag){al(i)}});e9.on(kK[1],"mouseup",function(i){if(kM._map.currentOperation!==ep.dragging&&kM._map.currentOperation!==ep.stdMapCtrlDrag){al(i)}});e9.on(kK[0],"contextmenu",function(i){d(i)});e9.on(kK[1],"contextmenu",function(i){d(i)});var kN=kL.children[1].children[2].children[2];e9.on(kN,"mouseup",function(i){if(kM._map.currentOperation!==ep.dragging&&kM._map.currentOperation!==ep.stdMapCtrlDrag){al(i)}});e9.on(kK[0],"click",function(i){al(i)});e9.on(kK[1],"click",function(i){al(i)});e9.on(kN,"click",function(i){al(i)});var kJ=kL.children[1].children[2].children[3];e9.on(kJ,"mouseup",function(i){if(i.button==2){al(i)}});e9.on(kJ,"contextmenu",function(i){d(i)});e9.on(this._zoomDom.children[3].children[0],"click",function(i){kM._map.zoomTo(18)});e9.on(this._zoomDom.children[3].children[1],"click",function(i){kM._map.zoomTo(12)});e9.on(this._zoomDom.children[3].children[2],"click",function(i){kM._map.zoomTo(8)});e9.on(this._zoomDom.children[3].children[3],"click",function(i){kM._map.zoomTo(4)});e9.on(kN,"mousedown",function(kO){kO=window.event||kO;var i=kO.offsetY||kO.layerY||0;var kP=0;kP=(kM._maxZoomLevel+1)-Math.round(kM._totalZoomLv*parseFloat(i/(kM._totalZoomLv*kM._sliderInterval)));kM._map.zoomTo(kP);kE?fM(6006):null});e9.on(kJ,"mouseover",function(){e9.ac(kJ,"h")});e9.on(kJ,"mouseout",function(){if(kM._map.currentOperation!==ep.stdMapCtrlDrag){e9.rc(kJ,"h")}});var kI=function(i){var i=window.event||i;if(i.button==2){return}if((e9.Browser.ie&&i.button!=1)){return}if(kJ.setCapture){kJ.setCapture()}kM._map.currentOperation=ep.stdMapCtrlDrag;kM._bind.my=i.pageY||i.clientY||0;if(!e9.Browser.opera){kM._setSliderBarCursor(E.draggingCursor)}e9.on(document,"mousemove",e);e9.on(document,"mouseup",T);al(i);return d(i)};var e=function(kO){if(kM._map.currentOperation===ep.stdMapCtrlDrag){var kO=window.event||kO;var kP=kO.pageY||kO.clientY;var i=kM._curBarY-kP+kM._bind.my;if(i<kM._minBarY){i=kM._minBarY}else{if(i>kM._maxBarY){i=kM._maxBarY}}kJ.style.top=(kM._sliderHeight-i-15)+"px";kM._sliderBotDom.style.height=i+"px"}};var T=function(kO){if(kM._map.currentOperation===ep.stdMapCtrlDrag){var i=e9.G(kJ);kM._curBarY=parseInt(i.style.top);e9.rc(kJ,"h");kM._map.currentOperation=ep.idle;if(kL&&kJ&&kJ.releaseCapture){kJ.releaseCapture()}if(!e9.Browser.opera){kM._setSliderBarCursor(E.defaultCursor)}var kP=(kM._maxZoomLevel+1)-Math.round(parseFloat(kM._curBarY-kM._minBarY)/parseFloat(kM._maxBarY-kM._minBarY)*(kM._totalZoomLv-1)+1);kM._map.zoomTo(kP);kE?fM(6006):null;e9.un(document,"mousemove",e);e9.un(document,"mouseup",T)}};e9.on(kJ,"mousedown",kI)},_setSliderBarCursor:function(e){this._container.children[1].children[2].children[3].style.cursor=e},_panBy:function(i,e){this._map.panBy(i,e)},_zoomIn:function(){this._map.zoomIn()},_zoomOut:function(){this._map.zoomOut()},_deepZoomOut:function(){this._map.deepZoomMedia(-1)},_deepZoomIn:function(){this._map.deepZoomMedia(1)},_setSliderZoomLv:function(i){if(!this._container||(this.getType()!=BMAP_NAVIGATION_CONTROL_LARGE&&this.getType()!=BMAP_NAVIGATION_CONTROL_ANIM)){return}var e=(i-this._minZoomLevel)*this._sliderInterval+this._minBarY;this._curBarY=e>this._maxBarY?this._maxBarY:e<this._minBarY?this._minBarY:e;this._container.children[1].children[2].children[3].style.top=(this._sliderHeight-this._curBarY-15)+"px";this._sliderBotDom.style.height=this._curBarY+"px"},_hideLevelHint:function(e){if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){if(this._container){e9.rc(this._container.children[1].children[3],"hvr")}}if(e&&this._hideTimerId){clearTimeout(this._hideTimerId);this._hideTimerId=null}},_showLevelHint:function(){if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){if(this._container){e9.ac(this._container.children[1].children[3],"hvr")}}},_expandSlider:function(){},_shrinkSlider:function(){},show:function(){gZ.prototype.show.call(this);if(e9.Browser.ie<8){var e=this;setTimeout(function(){e.setType(e._opts.type)},1)}}});e9.extend(kB.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){gZ.prototype.initialize.call(this,e);this._render(e);this._setParam();this._updateScale();this._bind(e);return this._container},_setParam:function(){this._numberArray={us:[5280*5000,5280*2500,5280*2000,5280*1000,5280*500,5280*200,5280*100,5280*50,5280*25,5280*20,5280*10,5280*5,5280*2,5280,2000,1000,500,200,100,50,20,10,5,2,1,0.5,0.5,0.5],metric:[10000000,5000000,2000000,1000000,500000,200000,100000,50000,25000,20000,10000,5000,2000,1000,500,200,100,50,20,10,5,2,1,0.5,0.5,0.5]}},_bind:function(i){var e=this;i.addEventListener("zoomend",function(T){e._updateScale()});i.addEventListener("load",function(T){e._updateScale()});i.addEventListener("moveend",function(T){e._updateScale()})},_render:function(e){gZ.prototype._render.call(this,e);e9.ac(this._container,"BMap_scaleCtrl");this._container.innerHTML=this._generateHTML();this._container.style.WebkitTextSizeAdjust="none";this._scaleText=this._container.children[0];gZ.prototype._setPosition.call(this);if(this.sateMapStyle){this.addSateMapStyle()}},_generateHTML:function(){var e=\'<div class="BMap_scaleTxt" style="white-space:nowrap;overflow:visible;text-align:center"></div><div class="BMap_scaleBarBG BMap_scaleHBarBG"></div><div class="BMap_scaleBarBG BMap_scaleRBarBG"></div><div class="BMap_scaleBarBG BMap_scaleLBarBG"></div><div class="BMap_scaleBar BMap_scaleHBar"></div><div class="BMap_scaleBar BMap_scaleLBar"></div><div class="BMap_scaleBar BMap_scaleRBar"></div>\';return e},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit;if(!this._map){return}this._updateScale()},_setScaleText:function(i,e){this._scaleText.innerHTML=i+"&nbsp;"+e},_updateScale:function(){if(!this._map||!this._container||!this._map.isLoaded()){return}var T=this._map;var kJ=new fv(Math.round(T.width/2-50),Math.round(T.height/2));var kF=new fv(Math.round(T.width/2+50),Math.round(T.height/2));var kC=T.pixelToPointIn(kJ,{heading:0});var kI=T.pixelToPointIn(kF,{heading:0});var kE=jy.getDistanceByMC(kC,kI)/100;if(kE===0||isNaN(kE)){return}var i=this._convertUnit(kE,this._opts.unit);var e=0;var kD=this._units[this._opts.unit].incon;var kH=Math.round(this._map.getZoom());kH=kH-1;var kG=this._numberArray[this._opts.unit][kH];e=kG/i;if(b5()&&e>100){while(e>100){kH+=1;kG=this._numberArray[this._opts.unit][kH];e=kG/i}}if(e>300){return}if(!b5()&&e>150){while(e>150){kH+=1;kG=this._numberArray[this._opts.unit][kH];e=kG/i}}var kK=kG>=kD?this._units[this._opts.unit].u2:this._units[this._opts.unit].u1;if(kG>=kD){kG=Math.round(kG/kD)}this._setScaleText(kG,kK);this._container.style.width=Math.round(e)+"px"},_convertUnit:function(e,i){i=i||"metric";if(this._units[i]){return e*this._units[i].conv}return e}});e9.extend(bB.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(i){this._map=i;var e=this;if(this.canCheckSize&&!this._checkSize(i)){return null}gZ.prototype.initialize.call(this,i);gZ.prototype._render.call(this);this.getMapCenter(function(){if(!e._map){return}e._draw();gZ.prototype._setPosition.call(e);e._bind(i)});return this._container},each:function(kD,T){for(var kC=0,e=kD.length;kC<e;kC++){T(kC,kD[kC])}},delegate:function(kC,T,i,e){var kD=this;if(!i.matchs){i.matchs=[];i.handle={}}i.matchs.push({filter:e,fn:T});if(!i.handle[kC]){i.addEventListener(kC,function(kF){var kE=kF.target;while(kE!=i){kD.each(i.matchs,function(kG,kI){var kH=new RegExp(kI.filter);if(kH.test(kE.getAttribute("filter"))){kI.fn.call(kE,kF,kE.getAttribute("filter"))}});kE=kE.parentNode}},false);i.handle.type=true}},_draw:function(){var kS=this;var kD=kS._cityBtn=b6("div",{"class":"ui_city_change"});var kF=kS._opts.anchor;var kN="";var kH=false;switch(kF){case BMAP_ANCHOR_TOP_LEFT:kN="float: left";break;case BMAP_ANCHOR_TOP_RIGHT:kN="float: right";break;case BMAP_ANCHOR_BOTTOM_LEFT:kN="float: left";kH=true;break;case BMAP_ANCHOR_BOTTOM_RIGHT:kN="float: right";kH=true;break;default:break}var kR=this.hotCityIds="hot_city_ids"+this._map.hashCode;var e=this.cityLetterListId="sel_city_letter_list"+this._map.hashCode;var kQ=this.cityDetailTableId="city_detail_table"+this._map.hashCode;var kC=this.curCityNameId="cur_city_name"+this._map.hashCode;var kJ=this.curCitySpn="cur_city_spn"+this._map.hashCode;kD.innerHTML=\'<a href="javascript:void(0)" onclick="return false" class="ui_city_change_inner" style="\'+kN+\'"><span id="\'+kC+\'" class="\'+kC+\'">\'+kS._map.cityName+"</span><i><em></em></i></a>";kD.style.position="relative";kD.style.height=34+"px";if(!kH){e9.ac(kD,"ui_city_change_top");kS._container.appendChild(kD)}var kI=kS._cityListWrap=b6("div",{"class":"citylist_popup_main"});var kU=\'<div class="citylist_ctr_title">城市列表</div>\';bS(kI,kU);var kK=b6("div",{"class":"citylist_ctr_content"});var i=b6("div",{"class":"city_content_top"});i.innerHTML=\'<p class="cur_city_info">当前城市：<span id="\'+kJ+\'">\'+kS._map.cityName+"</span</p>";var kE=\'<form id="city_ctrl_form" onsubmit="return false"><input type="text" class="sel_city_input" id="selCityWd\'+kS._map.hashCode+\'" name="wd" placeholder="请输入城市名" autocomplete="off"><span id="selCitySubmit\'+kS._map.hashCode+\'" class="selCitySubmit">搜索</span><div id="selCityTip\'+kS._map.hashCode+\'" style="display:none;height:20px;line-height:20px;color:#AE6842;border:1px solid #E8AA6C;background:#FEFAF1;width:121px;text-align:center">请输入正确的城市</div></form>\';var T=bS(i,kE);kK.appendChild(i);var kG=b6("div",{"class":"city_content_medium"});var kP=\'<div id="\'+kR+\'" class="sel_city_hotcity">\'+this._geneHotCityHtml()+"</div>";var kL=\'<div id="\'+e+\'" class="sel_city_letterbar">\'+this._geneCityLetter()+"</div>";bS(kG,kP+kL);kK.appendChild(kG);var kO=b6("div",{"class":"city_content_bottom",id:"city_detail_tpl"+kS._map.hashCode});var kT=this._geneCitiesDetailHtml();kO.innerHTML=kT;kK.appendChild(kO);kI.appendChild(kK);var kM=kS._closeBtn=b6("button",{id:"popup_close"});kI.appendChild(kM);if(kS._opts.expand){kS.showListWrap(true)}else{kS.showListWrap(false)}if(kF==BMAP_ANCHOR_TOP_RIGHT||kF==BMAP_ANCHOR_BOTTOM_RIGHT){kI.style.left="-2px"}kS._container.appendChild(kI);if(kH){e9.ac(kD,"ui_city_change_bottom");kS._container.appendChild(kD)}e9.ac(kS._container,"BMap_CityListCtrl")},_checkSize:function(e){if(e.width&&e.width>400&&e.height&&e.height>350){return true}return false},_bind:function(e){var kL=this;var kF=kL.onChangeBefore||[];var kO=function(kU,kR){var kU=kU||window.event;var kS=kU.target||kU.srcElement;var kP=kS.getAttribute("name");al(kU);var kV=true;switch(kR){case"cityHotIds":for(var kQ=0;kQ<kF.length;kQ++){kF[kQ]&&kF[kQ]()}kL.changeCity(kP);break;case"cityLetters":if(kP=="other"){kP="Z"}var kT=e9.G("ctr_tr_"+kP+kL._map.hashCode);kL._listDetailTbl.scrollTop=kT.offsetTop;kV=false;break;case"cityName":for(var kQ=0;kQ<kF.length;kQ++){kF[kQ]&&kF[kQ]()}if(kP==="吉林"){kP="吉林省"}kL.changeCity(kP);break;default:break}if(kV){setTimeout(function(){kL.showListWrap(false)},200)}};var kK=function(){kL._toggleList()};var kI=function(kV){hI(kV);var kS=(Math.ceil(kV.wheelDelta/120)||-kV.detail/3);var kQ=kS>0?1:-1;var kR=kL._listDetailTable.clientHeight||kL._listDetailTable.offsetHeight;var kP=kL._listDetailTbl.clientHeight||kL._listDetailTbl.offsetHeight;var kT=0;var kU=kR-(kP-20);if(kQ>0){kL._listDetailTbl.scrollTop-=20;if(kL._listDetailTbl.scrollTop<=kT){kL._listDetailTbl.scrollTop=0}}else{kL._listDetailTbl.scrollTop+=20;if(kL._listDetailTbl.scrollTop>=kU){kL._listDetailTbl.scrollTop=kU}}};if(kL._container){var kG=kL._cityBtn;var kM=kL._closeBtn;var kN=e9.G(kL.hotCityIds);var kJ=e9.G(kL.cityLetterListId);var kD=e9.G(kL.cityDetailTableId);var kE=e9.G(kL.curCityNameId);var i=e9.G(kL.curCitySpn);if(!kN){return}kL.delegate("click",kO,kN,"cityHotIds");kL.delegate("click",kO,kJ,"cityLetters");kL.delegate("click",kO,kD,"cityName");e9.on(kG,"click",kK);e9.on(kM,"click",function(){kL.showListWrap(false)});kL._map.addEventListener("citychange",function(kP){kL.getMapCenter(function(){kL.curCityName=kL._map.cityName;if(kL._map.cityName=="中国"){kL.curCityName="全国"}kL.curCityCode=kL._map.cCode;kE.innerHTML=kL.curCityName;i.innerHTML=kL.curCityName})});e9.on(kL._cityListWrap,"mousewheel",function(kP){hI(kP)});if(window.addEventListener){kL._cityListWrap.addEventListener("DOMMouseScroll",function(kP){hI(kP)},false)}var kC=kL._listDetailTbl=e9.G("city_detail_tpl"+kL._map.hashCode);var T=kL._listDetailTable=e9.G(kL.cityDetailTableId);e9.on(kC,"mousewheel",kI);if(window.addEventListener){kC.addEventListener("DOMMouseScroll",kI,false)}var kH=e9.G("selCitySubmit"+kL._map.hashCode);kH.addEventListener("click",function(kR){hI(kR);for(var kP=0;kP<kF.length;kP++){kF[kP]&&kF[kP]()}var kQ=e9.G("selCityWd"+kL._map.hashCode).value;if(kQ.length>0&&kQ.length<20){kQ=kQ.replace(/(\s)/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");kL.changeCity(kQ,true)}else{e9.G("selCityTip"+kL._map.hashCode).style.display="block";return}});e9.on(kL._cityListWrap,"click",function(kP){e9.G("selCityTip"+kL._map.hashCode).style.display="none"})}},_geneHotCityHtml:function(){var kE=this;var kD=kE.getHotCities();var kC="";var T="";for(var e=0;e<kD.length;e++){if(e==0){T="font-weight:bold"}kC+=\'<a href="javascript:void(0)" filter="cityHotIds" name="\'+kD[e]+\'" style="margin-right:7px;*margin-right:1px;\'+T+\'">\'+kD[e]+"</a>";T=""}return kC},_geneCityLetter:function(){var kD=["A","F","G","H","J","L","N","Q","S","T","X","Y","Z","其他"];var kC="";var e="";for(var T=0;T<kD.length;T++){if(T==kD.length-1){e="other"}else{e=kD[T]}kC+=\'<a href="javascript:void(0)" filter="cityLetters" name="\'+e+\'">\'+kD[T]+"</a>"}return kC},_geneCitiesDetailHtml:function(){var kH=this.getCitiesNames();var kF=\'<table id="\'+this.cityDetailTableId+\'" style="border-collapse:collapse;border-spacing:0" cellpadding="0" cellspacing="0">\';for(var kE in kH){var e=false;if(kE=="特别行政区"){kF+=\'<tr><td class="sel_city_letter"><div></div></td>\';kF+=\'<td class="sel_city_other sel_city_sf"><a href="javascript:void(0)" class="sel_city_name">\'+kE+"</a></td>";kF+=\'<td><div class="bmap-clearfix city_names_wrap">\';for(var T=0;T<kH[kE].length;T++){kF+=\'<a class="sel_city_name" href="javascript:void(0)" filter="cityName" name="\'+kH[kE][T]+\'">\'+kH[kE][T]+"</a>"}kF+="</div></td></tr>"}else{for(var kD in kH[kE]){if(!e){kF+=\'<tr id="ctr_tr_\'+kE+this._map.hashCode+\'"><td class="sel_city_letter"><div>\'+kE+"</div></td>";e=true}else{kF+=\'<tr><td class="sel_city_letter"><div></div></td>\'}kF+=\'<td class="sel_city_sf"><a href="javascript:void(0)" filter="cityName" name="\'+kD+\'">\'+kD+":</a></td>";kF+=\'<td><div class="bmap-clearfix city_names_wrap">\';var kG=kH[kE][kD];for(var kC=0;kC<kG.length;kC++){kF+=\'<a class="sel_city_name" href="javascript:void(0)" filter="cityName" name="\'+kH[kE][kD][kC]+\'">\'+kH[kE][kD][kC]+"</a>"}kF+="</div></td></tr>"}}}kF+="</table>";return kF},showListWrap:function(e){var i=this;if(i._cityListWrap){e?i._cityListWrap.style.display="block":i._cityListWrap.style.display="none";if(e){i._container.style.width=400+"px"}else{i._container.style.width="auto";i._container.style.height="auto"}}if(i._cityBtn){e?e9.ac(i._cityBtn,"ui_city_change_click"):e9.rc(i._cityBtn,"ui_city_change_click")}},changeCity:function(e,kD){var T=this;if(T._container&&T._cityBtn){var kC=e9.G(T.curCityNameId);var i=e9.G(T.curCitySpn);kl.request(function(kF){var kG=T.onChangeAfter||[];var kH=T.onChangeSuccess||[];setTimeout(function(){for(var kL=0;kL<kG.length;kL++){kG[kL]&&kG[kL]()}},300);if(kF&&kF.result&&kF.result["type"]==fB){if(kF.content.hasOwnProperty("error")||kF.err_msg.length>0){if(kD){e9.G("selCityTip"+T._map.hashCode).style.display="block"}return}var kK=kF.content;if(kK){var kJ={title:kK.cname||"",uid:kK.uid||"",point:bP.parseGeo(kK.geo,true).point||"",city:kK.cname||"",code:kK.code||"",level:kK.level||T._map.getZoom()};var kK=kJ.point;var kI=bP.getBestLevel(kJ.level,T._map);if(isNaN(kI)){kI=T._map.getZoom()}if(kF.content["code"]==1){kI=5}if(kD){setTimeout(function(){T.showListWrap(false)},200)}T._map.centerAndZoom(kK,kI);kC.innerHTML=kJ.city;i.innerHTML=kJ.city;for(var kE=0;kE<kH.length;kE++){kH[kE]&&kH[kE](kJ)}}}},{qt:dn,wd:e,dtype:1})}},_toggleList:function(){var i=this;if(i._cityListWrap){var e=i._cityListWrap.style.display=="none"?false:true;i.showListWrap(!e)}},getHotCities:function(){return["全国","北京","上海","广州","深圳","成都","天津","南京","武汉","杭州","重庆"]},getCitiesNames:function(){return{A:{"安徽":["合肥","安庆","蚌埠","亳州","巢湖","池州","滁州","阜阳","淮北","黄山","六安","马鞍山","宿州","铜陵","芜湖","宣城","淮南"]},F:{"福建":["福州","龙岩","南平","宁德","莆田","泉州","三明","厦门","漳州"]},G:{"广东":["广州","潮州","东莞","佛山","河源","惠州","江门","揭阳","茂名","梅州","清远","汕头","汕尾","韶关","深圳","阳江","云浮","湛江","肇庆","中山","珠海"],"广西":["南宁","百色","北海","崇左","防城港","桂林","贵港","河池","贺州","来宾","柳州","钦州","梧州","玉林"],"贵州":["贵阳","安顺","毕节","六盘水","铜仁","遵义","黔西南州","黔东南州","黔南州"],"甘肃":["兰州","白银","定西","甘南州","嘉峪关","金昌","酒泉","临夏州","陇南","平凉","庆阳","天水","武威","张掖"]},H:{"海南":["海口","白沙黎族自治县","保亭黎族苗族自治县","昌江黎族自治县","儋州","澄迈","东方","定安","琼海","琼中黎族苗族自治县","乐东黎族自治县","临高","陵水黎族自治县","三亚","屯昌","万宁","文昌","五指山","三沙"],"河南":["郑州","安阳","鹤壁","焦作","开封","洛阳","漯河","南阳","平顶山","濮阳","三门峡","商丘","新乡","信阳","许昌","周口","驻马店","济源"],"黑龙江":["哈尔滨","大庆","大兴安岭地区","鹤岗","黑河","鸡西","佳木斯","牡丹江","七台河","齐齐哈尔","双鸭山","绥化","伊春"],"湖北":["武汉","鄂州","恩施","黄冈","黄石","荆门","荆州","潜江","神农架林区","十堰","随州","天门","仙桃","咸宁","襄阳","孝感","宜昌"],"湖南":["长沙","常德","郴州","衡阳","怀化","娄底","邵阳","湘潭","湘西州","益阳","永州","岳阳","张家界","株洲"],"河北":["石家庄","保定","沧州","承德","邯郸","衡水","廊坊","秦皇岛","唐山","邢台","张家口"]},J:{"江苏":["南京","常州","淮安","连云港","南通","苏州","宿迁","泰州","无锡","徐州","盐城","扬州","镇江"],"江西":["南昌","抚州","赣州","吉安","景德镇","九江","萍乡","上饶","新余","宜春","鹰潭"],"吉林":["长春","白城","白山","吉林市","辽源","四平","松原","通化","延边朝鲜族自治州"]},L:{"辽宁":["沈阳","鞍山","本溪","朝阳","大连","丹东","抚顺","阜新","葫芦岛","锦州","辽阳","盘锦","铁岭","营口"]},N:{"宁夏":["银川","固原","石嘴山","吴忠","中卫"],"内蒙古":["呼和浩特","阿拉善盟","包头","巴彦淖尔","赤峰","鄂尔多斯","呼伦贝尔","通辽","乌海","乌兰察布","锡林郭勒盟","兴安盟"]},Q:{"青海":["西宁","果洛州","海东","海北州","海南州","海西州","黄南州","玉树州"]},S:{"山东":["济南","滨州","东营","德州","菏泽","济宁","聊城","临沂","青岛","日照","泰安","威海","潍坊","烟台","枣庄","淄博"],"山西":["太原","长治","大同","晋城","晋中","临汾","吕梁","朔州","忻州","阳泉","运城"],"陕西":["西安","安康","宝鸡","汉中","商洛","铜川","渭南","咸阳","延安","榆林"],"四川":["成都","阿坝州","巴中","达州","德阳","甘孜州","广安","广元","乐山","凉山州","泸州","南充","眉山","绵阳","内江","攀枝花","遂宁","雅安","宜宾","资阳","自贡"]},T:{"台湾":["台北","高雄","台中","台南","新北市","基隆","新竹","嘉义"]},X:{"西藏":["拉萨","阿里地区","昌都","林芝市","那曲","日喀则","山南"],"新疆":["乌鲁木齐","阿拉尔","阿克苏地区","阿勒泰地区","巴音郭楞蒙古自治州","博尔塔拉州","昌吉州","哈密","和田地区","喀什地区","克拉玛依","克孜勒苏州","石河子","塔城地区","图木舒克","吐鲁番","五家渠","伊犁州","北屯","铁门关","双河","可克达拉","昆玉"]},Y:{"云南":["昆明","保山","楚雄州","大理州","德宏州","迪庆州","红河州","丽江","临沧","怒江州","普洱","曲靖","昭通","文山","西双版纳傣族自治州","玉溪"]},Z:{"浙江":["杭州","湖州","嘉兴","金华","丽水","宁波","衢州","绍兴","台州","温州","舟山"]},"特别行政区":["香港","澳门"]}},getMapCenter:function(i){var kD=this._map;var T=kD.getBounds();var kE=kD.getZoom();var e=jy.convertLL2MC(T.getSouthWest());var kC=jy.convertLL2MC(T.getNorthEast());kl.request(function(kH){if(kH&&kH.current_city&&kH.current_city["name"]){var kG=kH.current_city["name"];var kF=kH.current_city["code"];this.curCityName=kD.cityName=kG;this.curCityCode=kD.cCode=kF;if(i){i.call(this)}}},{qt:"cen",b:e.lng+","+e.lat+";"+kC.lng+","+kC.lat,l:kE},"","",true)}});var bR=new String(E.imgPath+"maptype.png?20150903");bR.toCss=function(e,T){e=typeof e==="number"?e+"px ":"";T=typeof T==="number"?T+"px ":"";var i="transparent url("+this+") no-repeat "+e+T;return i};var gs=[[0,-138],[-11,-138]];gs.toCss=function(i){var e=this[Number(i)];return e[0]+"px "+e[1]+"px"};var jm={B_EARTH_MAP:{text:"3D地球",title:"显示3D地球",file:bR,x:0,y:-92,right:0},B_NORMAL_MAP:{text:"地图",title:"显示普通地图",file:bR,x:0,y:0,right:0}};var bk={B_NORMAL_MAP:{first:"B_EARTH_MAP",second:"B_NORMAL_MAP",showMenu:true},B_EARTH_MAP:{first:"B_NORMAL_MAP",second:"B_EARTH_MAP",showMenu:false}};var dE=["B_NORMAL_MAP","B_EARTH_MAP"];var jc={HIGHLIGHT:"#0c88e8",NORMAL:"#ffffff",HIGHLIGHT_TEXT:"#ffffff",NORMAL_TEXT:"#666666"};e9.extend(A.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(kR){gZ.prototype.initialize.call(this,kR);gZ.prototype._render.call(this);gZ.prototype._setPosition.call(this);this.mapTypeButtons={};var kE=jc;var kC={top:"0px",cursor:"pointer",width:"49px",height:"46px",zIndex:"800",display:"inline-block",position:"absolute",fontSize:"12px",backgroundColor:"#fff"};var T={width:"49px",height:"46px",position:"absolute"};var kS={position:"absolute",top:"28px",left:"2px",width:"45px",height:"16px",backgroundColor:kE.NORMAL,opacity:"0.8",filter:"Alpha(opacity=80);"};var kJ={position:"absolute",top:"30px",left:"2px",width:"45px",color:"#666666",textAlign:"center",lineHeight:"12px"};if(e9.isIE>0&&e9.isIE<=8){kJ.lineHeight="15px"}e9.extend(this._container.style,{top:"10px",width:"49px",height:"98px"});this._container.style.background="url("+E.imgPath+"blank.gif)";this._container.style.WebkitTransition=this._container.style.transition="top .3s ease-out";var e=b6("div");this._menu=e;e9.extend(e.style,{position:"absolute",width:"71px",height:"24px",border:"1px solid #ABAEB3",fontSize:"12px",bottom:"20px",right:"0",backgroundColor:"white",display:"none",cursor:"pointer"});var kH=b6("span");kH._checked=this._map.isStreetLayerShow();var kF=gs[1];e._checkbox=kH;e9.extend(kH.style,{background:bR.toCss(kF[0],kF[1]),width:"11px",height:"11px",position:"absolute",cssFloat:"left",top:"7px",left:"4px"});e.appendChild(kH);var kI=b6("span");kI.innerHTML="显示路网";e9.extend(kI.style,{position:"absolute",top:"5px",marginLeft:"18px"});e.appendChild(kI);kI.onmouseover=al;kI.onmouseout=al;e.onmouseover=al;e.onmouseout=al;this._container.appendChild(e);for(var kL=0,kN=dE.length;kL<kN;++kL){var kT=dE[kL];var kD=jm[kT];var kM=b6("div");kM.title=kD.title;kM._name=kT;e9.extend(kM.style,kD);e9.extend(kM.style,kC);var kK=b6("div");kK.style.position="absolute";kK.style.width="49px";kK.style.height="46px";kK.style.left=kK.style.top="0";kK.style.zIndex="999";kM._mask=kK;kM.appendChild(kK);var kG=b6("span");kM._captionBg=kG;e9.extend(kG.style,kS);kG.onmouseover=al;kG.onmouseout=al;var kP=b6("span");kM._innerBox=kP;e9.extend(kP.style,T);var kQ=bR.toCss(kD.x,kD.y);kP.style.background=kQ;var kO=b6("span");kM._caption=kO;kO.innerHTML=kD.text;e9.extend(kO.style,kJ);kM.appendChild(kP);kP.appendChild(kG);kP.appendChild(kO);kO.onmouseover=al;this._container.appendChild(kM);this.mapTypeButtons[kT]=kM}this._bind(kR);this.updateUI(this._map.mapType);return this._container},_bind:function(i){var e=this;this._container.ondblclick=al;this.mapTypeButtons.B_NORMAL_MAP._mask.onclick=function(){e._map.setMapType("B_NORMAL_MAP")};this.mapTypeButtons.B_EARTH_MAP._mask.onclick=function(){e._map.setMapType("B_EARTH_MAP")};this.mapTypeButtons.B_NORMAL_MAP._mask.onmouseover=function(){e._dehighlightAll();e._highlight(e.mapTypeButtons.B_NORMAL_MAP)};this.mapTypeButtons.B_EARTH_MAP._mask.onmouseover=function(){e._dehighlightAll();e._highlight(e.mapTypeButtons.B_EARTH_MAP)};this.mapTypeButtons.B_NORMAL_MAP._mask.onmouseout=this.mapTypeButtons.B_EARTH_MAP._mask.onmouseout=function(){e._dehighlightAll()};this._menu.onclick=function(T){e._map.showStreetLayer(!e._menu._checkbox._checked);al(T);return false};this._menu.ondblclick=al;i.addEventListener("onmaptypechange",function(T){e.updateUI(this.mapType)});i.addEventListener("onstreetlayer_show",function(T){e._menu._checkbox._checked=true;e._menu._checkbox.style.backgroundPosition=gs.toCss(true)});i.addEventListener("onstreetlayer_hide",function(T){e._menu._checkbox._checked=false;e._menu._checkbox.style.backgroundPosition=gs.toCss(false)});i.addEventListener("forceenableearth",function(T){if(this.config.enableEarth){e.showButton("B_EARTH_MAP");e.hideButton("B_NORMAL_MAP")}})},updateUI:function(T){this.hideButton(T);var kE=bk[T];var kC=this.mapTypeButtons[kE.first];kC.style.top="0";kC.style.display="inline-block";this.showButton(kE.first);var e=this.mapTypeButtons[kE.second];e.style.display="none";this.showButton(kE.second);if(T!=="B_NORMAL_MAP"){var i=this._map.isStreetLayerShow();var kD=this._menu;kD._checkbox._checked=i;kD._checkbox.style.backgroundPosition=gs.toCss(i);kD.style.display=""}else{this._menu.style.display="none"}if(!this._map.config.enableEarth){this.hideButton("B_EARTH_MAP")}},remove:function(){var kC=this.mapTypeButtons;for(var T=0,e=kC.length;T<e;++T){kC[T]=null}gZ.prototype.remove.call(this)},hideButton:function(i){var e=this.mapTypeButtons[i];if(!e){return}if(e.style){e.style.visibility="hidden"}},showButton:function(i){var e=this.mapTypeButtons[i];if(!e){return}if(e.style){e.style.visibility="visible"}},isButtonVisible:function(i){var e=this.mapTypeButtons[i];if(!e){return}return e.style.visibility==="visible"},_highlight:function(e){if(!e){return}e._captionBg.style.backgroundColor=jc.HIGHLIGHT;e._captionBg.style.opacity="1";e._captionBg.style.filter="";e._caption.style.color=jc.HIGHLIGHT_TEXT},_dehighlight:function(e){if(!e){return}e._captionBg.style.backgroundColor=jc.NORMAL;e._captionBg.style.opacity="0.8";e._captionBg.style.filter="Alpha(opacity=80);";e._caption.style.color=jc.NORMAL_TEXT},_dehighlightAll:function(){this._dehighlight(this.mapTypeButtons.B_NORMAL_MAP);this._dehighlight(this.mapTypeButtons.B_EARTH_MAP);this._dehighlight(this.mapTypeButtons.B_SATELLITE_MAP)}});e9.extend(jB.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(i){this._map=i;var kC=this._container=document.createElement("div");kC.style.cssText="box-shadow: 0 2px 6px 0 rgba(107,120,137,0.20), 0 4px 10px 0 rgba(91,98,107,0.08);background:rgba(255,255,255,1);";kC.className="BMap_stdMpZoom";var e=this._zoomIn=document.createElement("div");e.className="BMap_button_new BMap_stdMpZoomIn";e.innerHTML=\'<div class="BMap_smcbg in" style="position: absolute"></div>\';var T=this._zoomOut=document.createElement("div");T.className="BMap_button_new BMap_stdMpZoomOut";T.innerHTML=\'<div class="BMap_smcbg out" style="position: absolute; top: 36px;"></div>\';kC.appendChild(e);kC.appendChild(T);i.getContainer().appendChild(kC);this.bindEvt();if(this._visible===false){kC.style.display="none"}return kC},_generateZoomHtml:function(){var e=\'<div class="BMap_button_new BMap_stdMpZoomIn" title="放大一级"><div class="BMap_smcbg in"></div></div><div class="BMap_button_new BMap_stdMpZoomOut" title="缩小一级"><div class="BMap_smcbg out"></div></div>\';return e},bindEvt:function(){var e=this;var i=e._map;e._zoomIn.onclick=function(){i.zoomIn();e._zoomInTapped=false;this.style.background=""};e._zoomOut.onclick=function(){i.zoomOut();e._zoomOutTapped=false;this.style.background=""};e._zoomIn.ontouchstart=function(T){if(e._zoomInDisabled){return}e._zoomInTapped=true;this.style.background="#9b9b9b";T.preventDefault()};e._zoomIn.ontouchend=function(){if(!e._zoomInTapped){return}i.zoomIn();e.updateUI();e._zoomInTapped=false;this.style.background=""};e._zoomOut.ontouchstart=function(T){if(e._zoomOutDisabled){return}e._zoomOutTapped=true;this.style.background="#9b9b9b";T.preventDefault()};e._zoomOut.ontouchend=function(){if(!e._zoomOutTapped){return}i.zoomOut();e.updateUI();e._zoomOutTapped=false;this.style.background=""};e.zoomChangeHandler=function(){};i.addEventListener("zoomend",e.zoomChangeHandler);i.addEventListener("load",e.zoomChangeHandler)},updateUI:function(){var e=this._map;if(e.getZoom()>=e.getMaxZoom()){this._zoomInDisabled=true}else{this._zoomInDisabled=false;this._zoomIn.childNodes[0].style.backgroundPosition="0px 0px"}if(e.getZoom()<=e.getMinZoom()){this._zoomOutDisabled=true}else{this._zoomOutDisabled=false;this._zoomOut.childNodes[0].style.backgroundPosition="-8px 0"}}});e9.extend(gF.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}if(this._startLocationCalled){this.startLocation();this._startLocationCalled=false}},initialize:function(e){gZ.prototype.initialize.call(this,e);this._render(e);this._bind(e);return this._container},startLocation:function(){var T=this;var e=true;if(T.onLocationStart){function kC(kE){T._onLocSuccess(kE,true)}function kD(){T._onLocFailure()}e=T.onLocationStart(kC,kD)}if(e===false){return}if(!navigator.geolocation){return}var i={enableHighAccuracy:false,maximumAge:1000,timeout:30000};this.watchId&&navigator.geolocation.clearWatch(this.watchId);this.watchId=null;navigator.geolocation.getCurrentPosition(function(kE){T._onLocSuccess(kE,true)},function(kE){T._onLocFailure(kE)},i);if(this.watchPosition){this.watchId=navigator.geolocation.watchPosition(function(kE){T._onLocSuccess(kE,false)},function(kE){},i)}},stopLocationTrace:function(){if(navigator.geolocation){this.watchId&&navigator.geolocation.clearWatch(this.watchId)}},_render:function(T){var i=this._container=document.createElement("div");i.style.cssText="width:39px;height:39px;box-shadow: 0 2px 6px 0 rgba(107,120,137,0.20), 0 4px 10px 0 rgba(91,98,107,0.08);background:#fff;cursor:pointer;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;border-radius: 4px;";var kC=this._locBtn=document.createElement("div");kC.style.cssText=\'position: absolute;left: 50%;top: 50%;margin-left: -10px;margin-top: -10px;width: 20px;height: 20px;background: url("\'+E.imgResources.locNewPng+\'") 0 0;background-size: 48px 116px;\';i.appendChild(kC);var e=this._locFailTip=document.createElement("div");e.innerHTML="定位失败";e.style.cssText="display:none;position:absolute;left:45px;top:50%;width: 52px;height:20px;line-height:20px;margin-top:-10px;font-size:12px;box-shadow:1px 1px 2px rgba(0,0,0,.4);background:rgba(255,255,255,1);border-radius:3px;padding-left:5px;";i.appendChild(e);T.getContainer().appendChild(i);return i},_bind:function(){var e=this;function T(){e._buttonTapped=true;this.style.background="#9b9b9b"}function i(){if(e._buttonTapped===false){return}e._buttonTapped=false;e.startLocation();this.style.background="#fff"}if(!b5()){e._container.addEventListener("mousedown",T,false);e._container.addEventListener("mouseup",i,false)}else{e._container.addEventListener("touchstart",T,false);e._container.addEventListener("touchend",i,false)}},_onLocSuccess:function(kG,kJ){var kF=this;var kH=kG.coords.longitude;var kE=kG.coords.latitude;if(kG.coordsType==="bd09mc"){var T=new cG(kH,kE);if(!kF.locMarker){kF._addLocOverlay(T)}else{kF._refreshLocOverlayPosition(T,kJ)}return}var kI=1;if(kG.coordsType==="bd09ll"){kI=5}var kC=kH+","+kE;var kD="locCbk"+Math.floor(Math.random()*10000000000);bG[kD]=function(kL){if(kL&&kL.result&&kL.result.length>0){var kK=kL.result[0];var kM=new cG(kK.x,kK.y);if(!kF.locMarker){kF._addLocOverlay(kM)}else{kF._refreshLocOverlayPosition(kM,kJ)}}delete bG[kD]};if(window._BMapSecurityConfig&&window._BMapSecurityConfig["serviceHost"]){var i=window._BMapSecurityConfig["serviceHost"]+"geoconv/v1/?coords="+kC+"&from="+kI+"&to=6&v=gl&type=webgl&callback="+fF+"."+kD}else{var i="//api.map.baidu.com/geoconv/v1/?coords="+kC+"&from="+kI+"&to=6&v=gl&type=webgl&ak="+eZ+"&callback="+fF+"."+kD}g4.load(i);var e=new fW("onlocationSuccess");e.point=kG.coords;this.dispatchEvent(e)},_onLocFailure:function(){var T=this;var i="pc";if(b5()){i="mb"}if(window._BMapSecurityConfig&&window._BMapSecurityConfig["serviceHost"]){var e={qterm:i,coding:"utf-8",coord:"bd09ll",extensions:1,callback_type:"jsonp",qt:j7,}}else{var e={qterm:i,coding:"utf-8",coord:"bd09ll",extensions:1,callback_type:"jsonp",ak:eZ,qt:j7,}}kl.request(function(kE){if(kE&&kE.content&&kE.content.location){var kD={coords:{longitude:kE.content.location.lng,latitude:kE.content.location.lat},coordsType:"bd09ll"};T._onLocSuccess(kD,true)}else{var kC=T._locFailTip;kC.style.display="block";setTimeout(function(){kC.style.display="none"},1000);var kF=new fW("onlocationError");kF.code=-1;T.dispatchEvent(kF)}},e)},_addLocOverlay:function(i){var T=this._map;var e=new jS(E.imgResources.locNewPng,new jo(48,48),{imageSize:new jo(48,116),imageOffset:new jo(0,20)});var kC=this.locMarker=new ke(i,{icon:e,baseZIndex:999999,enableMassClear:false,clickable:false});T.addOverlay(kC);if(this._opts.autoViewport){if(this._opts.autoZoom){T.centerAndZoomIn(i,this.locLevel)}else{T.setCenterIn(i)}}if(this.useCompass&&this._isSupportCompass()){this.switchToCompassState()}},_refreshLocOverlayPosition:function(i,e){this.locMarker.setPositionIn(i);if(this.headingMarker){this.headingMarker.setPositionIn(i)}if(e&&this._opts.autoViewport){if(this._opts.autoZoom){this._map.centerAndZoomIn(i,this.locLevel)}else{this._map.setCenterIn(i)}}},_isSupportCompass:function(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("android")>-1||!window.DeviceOrientationEvent||(e.indexOf("ucweb")>-1&&e.indexOf("linux")>-1)){return false}return true},switchToCompassState:function(){var T=this;var i=new jS(E.imgResources.locNewPng,new jo(48,48),{imageSize:new jo(48,116),imageOffset:new jo(0,68),anchor:new jo(24,24)});this.headingMarker=new ke(this.locMarker.getPositionIn(),{icon:i,baseZIndex:999998,enableMassClear:false,clickable:false});this._map.addOverlay(this.headingMarker);var e=0;var kC=window.orientation;window.addEventListener("deviceorientation",function(kF){var kE;if(!kF.webkitCompassHeading){kE=Math.round(kF.alpha)}else{kE=Math.round(0-kF.webkitCompassHeading)}kE=kE-kC;var kD=Math.abs(e-kE);if(kD>1){T.headingMarker.setRotation(0-kE);e=kE}},true);window.addEventListener("orientationchange",function(){kC=window.orientation},true)}});');
