/**/ï»¿_jsload&&_jsload('poly', 'iV.DOM_ATTRS={strokecolor:1,strokeweight:1,strokeopacity:1,fillcolor:1,fillopacity:1,strokelinecap:1,strokelinejoin:1,strokestyle:1,topfillcolor:1,topfillopacity:1,sidefillcolor:1,sidefillopacity:1};e9.extend(iV.prototype,{initialize:function(T){if(T&&this._graphMouseEvent){T.addEventListener("onmousemove",this._graphMouseEvent)}if(T&&this._graphClickEvent){T.addEventListener("onclick",this._graphClickEvent);T.addEventListener("ondblclick",this._graphClickEvent);T.addEventListener("onrightclick",this._graphClickEvent);T.addEventListener("onrightdblclick",this._graphClickEvent)}if((this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"||this._config.strokeTexture)&&T.getRenderType()==="webgl"&&!this._config.texture){this._generateTexture()}var e=eM.prototype.initialize.call(this,T);if(this._config.enableEditing===true&&!this._config.geodesic){var i=this;setTimeout(function(){i.clearVertexs();i.addVertexs()},0)}return e},_generateTexture:function(){var kF=this._config;if(kF.strokeTexture&&kF.strokeTexture.url){this._config.texture=kF.strokeTexture.url;var kG=kF.strokeTexture.width||16;var i=kF.strokeTexture.height||16;this._totalDashLen=kF.strokeWeight*Math.round(i/kG);this._config.textureSize=[kG,i];return}var kC=kF.dashArray;var kE=document.createElement("canvas");var e;var kD;if(kF.strokeStyle==="dashed"){e=16;kD=e*8}else{if(kF.strokeStyle==="dotted"){e=32;kD=e*2}}kE.width=e;kE.height=kD;var T=kE.getContext("2d");T.fillStyle=kF.strokeColor;T.globalAlpha=kF.strokeOpacity;if(kF.strokeStyle==="dashed"){this._drawDashArrayTexture(T,e,kD)}else{if(kF.strokeStyle==="dotted"){this._drawDottedTexture(T,e,kD)}}this._config.texture=kE;this._config.textureSize=[e,kD]},_drawDashArrayTexture:function(kI,kC,kE){var T=this._config;var kG=T.dashArray;if(!kG){kI.fillRect(0,0,kC,kE/2);this._totalDashLen=T.strokeWeight*4}else{var kH=0;if(kG.length%2!==0){kG=kG.concat(kG)}for(var kD=0;kD<kG.length;kD++){kH+=kG[kD]}var e=0;for(var kD=0;kD<kG.length;kD++){var kF=kG[kD]/kH*kE;if(kD%2===0){kI.fillRect(0,e,kC,kF)}e+=kF}this._totalDashLen=kH}},_drawDottedTexture:function(i,e,T){i.beginPath();i.arc(e/2,e/2,e/2,0,2*Math.PI);i.fill();i.closePath();this._totalDashLen=this._config.strokeWeight*2},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=f9.getDrawer(this.map);this.domElement=e.addLine()},_bind:function(){var e=this.domElement;var kC=this;function kE(kK,kI){var kH=kK.srcElement||kK.target;var kG=hb();var i=kK.pageX?kK.pageX:(kK.clientX+kG[1]);var kM=kK.pageY?kK.pageY:(kK.clientY+kG[0]);if(kK&&kI&&i&&kM&&kH){var kJ=e9.I(kH.hashCode).map;var kL=e9.Dom.getOffset(kJ.container);kI.pixel=new fv(i-kL.left,kM-kL.top);kI.point=kJ.pixelToPointIn(kI.pixel);kI.latLng=js(kJ.pixelToPoint(kI.pixel),BMapGL.coordType);return kI}else{return kI}}if(e&&f9.getDrawer(this.map).getType()!=="canvas"){e9.on(e,"click",function(i){kC.dispatchEvent(kE(i,new fW("onclick").inherit(i)))});e9.on(e,"mousedown",function(i){kC.dispatchEvent(kE(i,new fW("onmousedown").inherit(i)))});e9.on(e,"mouseup",function(i){kC.dispatchEvent(kE(i,new fW("onmouseup").inherit(i)))});e9.on(e,"dblclick",function(i){kC.dispatchEvent(kE(i,new fW("ondblclick").inherit(i)))})}e=null;if(!this._binded){this._binded=true;this.enableEventListen=true;this._graphMouseEvent=function(kJ){if(!kC.map){return}if(kC.map.getMapType()==="B_EARTH_MAP"){return}if(kC instanceof bG.PolylineMultipart||kC instanceof bG.Marker3D){return}if(kC.map.temp._draggingMarker){return}if(!kC.enableEventListen){return}var kG;if(kJ.overlay&&kJ.overlay.toString()==="Marker"){if(!kJ.overlay.keepWhenMousemoveOn){if(kC._temp.ismouseout===false&&kC._temp.ismouseover===true){kC._temp.ismouseover=false;kC._temp.ismouseout=true;kG=new fW("onmouseout");kC.dispatchEvent(kG)}return}}var i=kJ.point;var kI;if(kC.toString()!=="Polyline"){kI=kC._getInPnpoly(i)}else{kI=kC._getProximity(i)}var kH=kI.dist;if(kH>=0&&kH<kC._config.mouseOverTolerance){if(!kC._temp.ismouseover){kC._temp.ismouseover=true;kC._temp.ismouseout=false;kG=new fW("onmouseover")}else{kG=new fW("onmousemove");kC.map.platform.style.cursor=kC.map.config.overlayMoveCursor}}else{if(!kC._temp.ismouseout&&kC._temp.ismouseover){kC._temp.ismouseover=false;kC._temp.ismouseout=true;kG=new fW("onmouseout");kC.map.platform.style.cursor=kC.map.config.defaultCursor}}if(kG){if(kC.toString()!=="Polyline"&&kG.type==="onmousemove"&&kC._temp.ismouseover===true&&(kH===0||kH>kC._config.mouseOverTolerance)){kG.pixel=kJ.pixel;kG.point=kJ.point;kG.latLng=this.overlayPixelToPoint(kJ.pixel)}else{var i=new cG(kI.pixel.x,kI.pixel.y);kG.point=i;kG.pixel=this.pointToPixelIn(kG.point);kG.latLng=jy.convertMC2LL(i)}kC.dispatchEvent(kG)}};this._graphClickEvent=function(kJ){if(!kC.map){return}if(kC.map.getMapType()==="B_EARTH_MAP"){return}if(kC instanceof bG.PolylineMultipart||kC instanceof bG.Marker3D){return}if(kC.map.temp._draggingMarker){return}if(!kC.enableEventListen){return}var kG;var i=kJ.point;var kI;if(kC.toString()!=="Polyline"){kI=kC._getInPnpoly(i)}else{kI=kC._getProximity(i)}var kH=kI.dist;if(kH>=0&&kH<kC._config.mouseOverTolerance){kG=new fW(kJ.type)}if(kG){if(kC.toString()!=="Polyline"&&kG.type==="onmousemove"&&kC._temp.ismouseover===true&&(kH===0||kH>kC._config.mouseOverTolerance)){kG.pixel=kJ.pixel;kG.point=kJ.point;kG.latLng=this.overlayPixelToPoint(kJ.pixel)}else{var i=new cG(kI.pixel.x,kI.pixel.y);kG.point=i;kG.pixel=this.pointToPixelIn(kG.point);kG.latLng=jy.convertMC2LL(i);if(kC.toString()==="GroundOverlay"&&kC.canPixelMap&&kC.canPixelMap()){kG.color=kC.getImagePixel(kG.point);kG.value=kC.getValue(kG.color)}}kC.dispatchEvent(kG)}};this.map.addEventListener("onmousemove",this._graphMouseEvent);var kD=["onclick","dblclick","onrightclick","onrightdblclick"];for(var T=0;T<kD.length;T++){var kF=kD[T];this.map.addEventListener(kF,this._graphClickEvent)}this.addEventListener("mouseover",function(i){if(!this.map){return}});this.addEventListener("mouseout",function(i){if(!this.map){return}});this.map.addEventListener("movestart",function(){kC.enableEventListen=false;kC._mouseEventPixels=null});this.map.addEventListener("moveend",function(){kC.enableEventListen=true});this.map.addEventListener("zoomstart",function(){kC.enableEventListen=false;kC._mouseEventPixels=null});this.map.addEventListener("zoomend",function(){kC.enableEventListen=true});this.map.on("center_changed",function(){kC._mouseEventPixels=null});this.map.on("zoom_changed",function(){kC._mouseEventPixels=null});this.map.on("load",function(){kC._mouseEventPixels=null});this.map.on("heading_changed",function(){kC.enableEventListen=true});this.map.on("tilt_changed",function(){kC.enableEventListen=true})}},draw:function(kD){if(!this.domElement){return}var kC=this.map;if(kC.getMapType()==="B_EARTH_MAP"||kC._renderType==="webgl"){return}kD=kD||{};var T=this.points.slice(0);if(this.greatCirclePoints.length>0){T[0]=this.greatCirclePoints}var i=this._getDisplayPixels(T,kD.zoom,kD.center);if(this._drawer){this._drawer.setPath(this.domElement,i)}},_draw:function(){if(this.map){this.initialize(this.map);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}this.draw()}},_getDisplayPixels:function(kG,kH,e){var kC=this.map;var kF=[];if(kG.length==0||!this.isVisible()){return[kF]}if(kC._renderType!=="webgl"&&!this.domElement){return[kF]}var T=kG;if(!this._config.enableEditing&&this._config.enableParse){T=this._simplification(kG)}var kE=[];if(kG[0] instanceof cG){var kI=this._toOverlayPixels(T,kH,e);kE.push(kI.pixels);kE.isOnBack=kI.isOnBack}else{kE.isOnBack=false;for(var kD=0;kD<T.length;kD++){var kI=this._toOverlayPixels(T[kD],kH,e);kE.push(kI.pixels);if(kI.isOnBack===true){kE.isOnBack=true}}}return kE},_getMCPixels:function(kD){var kF=this.map;var kE=[];if(kD.length==0||!this.isVisible()){return[kE]}if(kF._renderType!=="webgl"&&!this.domElement){return[kE]}var kG=kD;if(!this._config.enableEditing&&this._config.enableParse){kG=this._simplification(kD)}var kC=[];if(kD[0] instanceof cG){var e=this._toMCPixels(kG);kC.push(e.pixels)}else{for(var T=0;T<kG.length;T++){var e=this._toMCPixels(kG[T]);kC.push(e.pixels)}}return kC},_toMCPixels:function(kC){var kH=this.map;var kG=[];var T=new fv(kC[0].lng,kC[0].lat);kG.push(T);for(var kF=1,kD=1,e=kC.length;kF<e;kF++){var kE=new fv(kC[kF].lng,kC[kF].lat);if(!kE.equals(kG[kD-1])){kG.push(kE);kD++}}return{pixels:kG}},_toOverlayPixels:function(kH,kK,e){var T=this.map;var kI;var kJ=[];var kG=T.pointToOverlayPixelIn(kH[0],{zoom:kK,center:e});kJ.push(kG);if(kG.onBack){kI=true}for(var kE=1,kD=1,kC=kH.length;kE<kC;kE++){var kF=T.pointToOverlayPixelIn(kH[kE],{zoom:kK,center:e});if(kF.onBack){kI=true}if(!kF.equals(kJ[kD-1])){kJ.push(kF);kD++}}return{pixels:kJ,isOnBack:kI}},getParseCacheIndex:function(e){e=Math.floor(e);if(this._config.getParseCacheIndex){return this._config.getParseCacheIndex(e)}if(e<6){return 0}if(e<10){return 1}if(e<15){return 2}return 3},getParseTolerance:function(i,e){i=Math.floor(i);if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return iV.parseTolerance[e][this.getParseCacheIndex(i)]},setPoints:function(i){this._clearCache();this.points=iV.getGraphPoints(i).slice(0);if(this.toString()==="GroundOverlay"&&this.updatePixelMc){this.updatePixelMc()}this._calcBounds();this.draw();var e=new fW("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(this._visible&&this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setPointAt:function(T,e){if(!e||!this.points[T]){return}this._clearCache();this.points[T]=new cG(e.lng,e.lat);this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=jy.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setOptions:function(i){i=i||{};var T=this.isStyleUseTexture();for(var e in i){if(i.hasOwnProperty(e)){var kD=this._config[e];var kC=i[e];this._config[e]=kC;if(kC!==kD&&(e==="strokeColor"||e==="strokeOpacity"||e==="strokeWeight"||e==="strokeStyle")){if(this._config.texture){this._config.texture=null}if(e==="strokeStyle"){T=this.isStyleUseTexture()}if(T){this._generateTexture()}}if(this.map){this._setDomAttribute(e.toLowerCase(),i[e])}}}},isStyleUseTexture:function(){if(!this.map){return false}if(this.map.getRenderType()!=="webgl"){return false}return this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"||this._config.strokeTexture},setStrokeColor:function(e){this.setOptions({strokeColor:e})},setStrokeLineCap:function(e){if(this._config){this._config.strokeLineCap=e}this._setDomAttribute("strokelinecap",e)},setStrokeLineJoin:function(e){if(this._config){this._config.strokeLineJoin=e}this._setDomAttribute("strokelinejoin",e)},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e;if(!this.map){return}this._setDomAttribute("strokeweight",e)}},setStrokeOpacity:function(e){if(isNaN(e)||e>1||e<0){return}this.setOptions({strokeOpacity:e})},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this._setDomAttribute("fillopacity",e)},setStrokeStyle:function(e){if(e!="solid"&&e!="dashed"&&e!="dotted"){return}this.setOptions({strokeStyle:e})},setFillColor:function(e){this._config.fillColor=e||"";this._setDomAttribute("fillcolor",e)},_setDomAttribute:function(i,T){if(!iV.DOM_ATTRS[i]){return}if(this._drawer){if(T===false||T===null||typeof T==="undefined"){T=""}this._drawer.setAttribute(this.domElement,i,T,this._config)}var e=new fW("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(i==="strokeweight"&&this.getStrokeStyle()==="dashed"&&f9.getDrawer(this.map)&&f9.getDrawer(this.map).getType()==="svg"){this._setDomAttribute("strokestyle","dashed")}},addVertexs:function(){var kG=this;if(kG.vertexMarkers.length){return}var kH=this.getVertexPoints();if(!kH){return}var kF;for(var kE=0,kC=kH.length;kE<kC;kE++){var e=kH[kE];if(e.t){if(this._config.nodeT&&this._config.nodeT instanceof jS){var T=this._config.nodeT}else{kF=E.imgPath+"nodeT.gif";var T=new jS(kF,new jo(11,11),{offset:new jo(5,5)})}}else{if(this._config.node&&this._config.node instanceof jS){var T=this._config.node}else{kF=E.imgPath+"node.gif";var T=new jS(kF,new jo(11,11),{offset:new jo(5,5)})}}var kD=new ke(e.p,{icon:T,delFlag:true});kD.enableDragging(true);kD.addEventListener("ondragging",function(kI){var i=new fW("onlinevertexdragging");i.overlay=this;i.from=kI;kG.dispatchEvent(i);kG._onMarkerDragging(kI)});kD.addEventListener("ondragstart",function(kI){var i=new fW("onlinevertexdragstart");i.overlay=this;i.from=kI;kG.dispatchEvent(i);kG._onMarkerDragstart(kI)});kD.addEventListener("ondragend",function(kI){var i=new fW("onlinevertexdragend");i.overlay=this;i.from=kI;kG.dispatchEvent(i);kG._onMarkerDragend(kI)});kD.addEventListener("onmarkerdelvertex",function(kI){var i=new fW("onlinevertexdel");i.overlay=this;i.from=kI;kG.dispatchEvent(i);kG._onMarkerDelVertex(kI)});kD.index=e.index;kD.t=e.t;kD.n=e.n;kD.inall=kE;this.vertexMarkers.push(kD)}if(this.map&&(!this.map._overlayMgrGL||this.map._overlayMgrGL._exitOverlay(this))){for(var kE=0,kC=this.vertexMarkers.length;kE<kC;kE++){this.map.addOverlay(this.vertexMarkers[kE])}}},clearVertexs:function(){if(!this.map){return}var e;while(e=this.vertexMarkers.pop()){this.map.removeOverlay(e);e=undefined}this.vertexMarkers.length=0},getVertexPoints:function(){var kF=[];if(this.hasMultipleParts){for(var kD=0;kD<this.points.length;kD++){for(var kE=0,T=this.points[kD].length;kE<T;kE++){var kG=this.points[kD][kE];kF.push({n:kD,index:kE*2,p:kG,t:0});if(kE<T-1){var e=this.points[kD][kE+1];var kC=new cG((kG.lng+e.lng)/2,(kG.lat+e.lat)/2);kF.push({n:kD,index:(kE*2)+1,p:kC,t:1})}}}}else{for(var kE=0,T=this.points.length;kE<T;kE++){var kG=this.points[kE];kF.push({n:-1,index:kE*2,p:kG,t:0});if(kE<T-1){var e=this.points[kE+1];var kC=new cG((kG.lng+e.lng)/2,(kG.lat+e.lat)/2);kF.push({n:-1,index:(kE*2)+1,p:kC,t:1})}}}this.vertexPoints=kF;return kF},delVertex:function(e){this.map.removeOverlay(this.vertexMarkers[e]);this.vertexPoints.splice(e,1);this.vertexMarkers.splice(e,1)},_onMarkerDragging:function(i){},_onMarkerDragstart:function(T){this._editstate=false;var i=new fW("oneditstart");i.pixel=T.pixel;i.point=T.point;i.latLng=T.latLng;i.overlay=this;this.dispatchEvent(i)},_onMarkerDragend:function(kD){this.vertexPoints.length=0;this._editstate=false;if(this._temp.dashedLine){this.map.removeOverlay(this._temp.dashedLine);delete this._temp.dashedLine}if(this._temp.preTNode){this.map.removeOverlay(this._temp.preTNode);delete this._temp.preTNode}if(this._temp.nexTNode){this.map.removeOverlay(this._temp.nexTNode);delete this._temp.nexTNode}var i=kD.currentTarget;var kG=kD.point;var kE=i.index;var kC;var kJ;var kI=this.points.slice();if(this.hasMultipleParts){kI=kI[i.n]}if(kE%2!=0){kE=Math.ceil(kE/2);kJ=kI.slice();var T=kI.length-kE;var kF=kJ.splice(kE,T);kJ[kJ.length]=kG;kJ=kJ.concat(kF)}else{kE=kE/2;kI.splice(kE,1,kG);if(this instanceof hB&&kI.length-1==kE){kI.splice(0,1,kG)}kJ=kI}if(this.hasMultipleParts){kC=this.points.slice();kC.splice(i.n,1,kJ)}else{kC=kJ}this.clearVertexs();this.setPoints(kC);this.addVertexs();var kH=new fW("oneditend");kH.pixel=kD.pixel;kH.point=kD.point;kH.latLng=kD.latLng;kH.overlay=this;this.dispatchEvent(kH);this._mouseEventPixels=null},_onMarkerDelVertex:function(kH){if(this.toString()!=="Polyline"&&this.toString()!=="Polygon"){return}if(kH.target.type===0||kH.target.t===0){var kL=[];if(this.vertexPoints.length<4&&this.toString()==="Polyline"){return}var kD=kH.target;var kI=kD.n;var kK=this.points;if(kI>=0){if(kK[kI].length<5&&this.toString()==="Polygon"){return}}else{if(this.vertexPoints.length<8&&this.toString()==="Polygon"){return}}if(this.toString()==="Polyline"||kI===-1){if(this.toString()==="Polygon"&&(kH.target.index===0||kH.target.index===(this.vertexPoints.length-1))){this.delVertex(this.vertexPoints.length-1);this.delVertex(0);this.vertexPoints[this.vertexPoints.length]=this.vertexPoints[1]}else{this.delVertex(kH.target.index)}for(var kF=0;kF<this.vertexPoints.length;kF++){if(this.vertexPoints[kF].t===0){kL.push(this.vertexPoints[kF].p)}}this.points=kL}else{var T=kD.inall;var kG=kK[kI].length*2;var kC=T-kH.target.index;var kE=T+(kG-2-kH.target.index);if(kH.target.index===0||kH.target.index===kG-2){this.delVertex(kE);this.delVertex(kC)}else{this.delVertex(T)}for(var kF=0;kF<this.vertexPoints.length;kF++){if(this.vertexPoints[kF].t===0){if(kL[this.vertexPoints[kF].n]){kL[this.vertexPoints[kF].n].push(this.vertexPoints[kF].p)}else{kL[this.vertexPoints[kF].n]=[this.vertexPoints[kF].p]}}}this.points=kL;if(this.points[kI][0].lng===this.points[kI][this.points[kI].length-1].lng&&this.points[kI][0].lat===this.points[kI][this.points[kI].length-1].lat){this.points[kI].splice(this.points[kI].length-1,1)}}this.clearVertexs();this.setPoints(this.points);this.addVertexs();var kJ=new fW("oneditend");kJ.pixel=kH.pixel;kJ.point=kH.point;kJ.latLng=kH.latLng;kJ.overlay=this;this.dispatchEvent(kJ);this._mouseEventPixels=null}},_getInPnpoly:function(T){var kC;var kG=[];var e=new fv(T.lng,T.lat);if(this._mouseEventPixels){kG=this._mouseEventPixels}else{if(!(this.points[0] instanceof cG)){var kF=this._getMCPixels(this.points);for(var kE=0;kE<kF.length;kE++){kF[kE].push(kF[kE][0]);kG=kG.concat(kF[kE])}}else{kG=this._getMCPixels(this.points)[0]}kG=kG[0]===undefined?[]:kG;this._mouseEventPixels=kG}var kD=this._pixelPnpoly(e,kG);kC=kD?0:1000;return{pixel:e,dist:kC}},_getProximity:function(kO){var T,kD,kP,kH,kF,kN,kM,kL=[];var kQ=new fv(kO.lng,kO.lat);if(this._mouseEventPixels){kL=this._mouseEventPixels}else{kL=this._getMCPixels(this.points)[0];kL=kL[0]===undefined?[]:kL;this._mouseEventPixels=kL}var kT=kL.length;if(kT>1){for(var kR=1;kR<kT;kR++){var kJ=kL[kR-1];var kX=kL[kR];if(!kJ||!kX){continue}if(kJ.x!=kX.x){var kW=(kX.y-kJ.y)/(kX.x-kJ.x);var kU=kX.y-kW*kX.x;kM=Math.abs(kW*kQ.x+kU-kQ.y)/Math.sqrt(kW*kW+1)}else{kM=Math.abs(kQ.x-kX.x)}var kS=Math.pow(kX.y-kJ.y,2)+Math.pow(kX.x-kJ.x,2);var kC=Math.pow(kX.y-kQ.y,2)+Math.pow(kX.x-kQ.x,2);var kV=Math.pow(kJ.y-kQ.y,2)+Math.pow(kJ.x-kQ.x,2);var kE=Math.pow(kM,2);var e=kC-kE+kV-kE;if(e>kS){kM=Math.sqrt(Math.min(kC,kV))}if((T==null)||(T>kM)){kD=Math.sqrt(kV-kE)/Math.sqrt(kS);kP=Math.sqrt(kC-kE)/Math.sqrt(kS);T=kM;kN=kR}T=Math.min(T,kM)}if(kD>1){kD=1}if(kP>1){kD=0;kP=1}var kK=kL[kN-1].x-kL[kN].x;var kI=kL[kN-1].y-kL[kN].y;kH=kL[kN-1].x-(kK*kD);kF=kL[kN-1].y-(kI*kD)}var kG=T/Math.pow(2,(18-this.map.getZoom()));return{pixel:new fv(kH,kF),mcMinDist:T,dist:kG}},_pixelPnpoly:function(kD,kF){var e=kF.length;var T=0;var kE=false;for(var kC=0;kC<e;kC++){T=(kC===e-1)?0:T+1;if((kF[kC].y!==kF[T].y)&&(((kD.y>=kF[kC].y)&&(kD.y<kF[T].y))||((kD.y>=kF[T].y)&&(kD.y<kF[kC].y)))&&(kD.x<(kF[T].x-kF[kC].x)*(kD.y-kF[kC].y)/(kF[T].y-kF[kC].y)+kF[kC].x)){kE=!kE}}return kE},getMinDistance:function(i){var e=this._getProximity(i);return e.mcMinDist},buildVertex:function(kD,kJ){var kG=[];var kK=[];var kM=this.points.slice(0);var kN=[];if(this.greatCirclePoints.length>0){kM[0]=this.greatCirclePoints}var T=iV.JOININDEX[this._config.strokeLineJoin];var kL=iV.CAPINDEX[this._config.strokeLineCap];var kC=this.getStrokeColorForGL();var e=this._config.strokeWeight/2;var kF=this.map.getZoom();if(kM.length>500&&kM[0] instanceof cG){if(!kJ&&this._lastResult){return this._lastResult}var kI=this._getDisplayPixelsGLWithCut(kM);for(var kE=0;kE<kI.length;kE++){if(kI[kE].length<2){continue}if(kG.length/6+kD.getVertexCount(kI[kE].length)>65536){kN.push([kG,kK]);kG=[];kK=[]}kD.buildData(kI[kE],T,kL,kG,kK,kC,e)}kN.push([kG,kK]);kN.inCache=false;this._lastResult=kN;return kN}var kH=this.getParseCacheIndex(this.map.getZoom());if(kJ!==true&&this._parseCacheGL[kH]){this._parseCacheGL[kH].inCache=true;return this._parseCacheGL[kH]}var kI=this._getDisplayPixelsGL(kM);for(var kE=0;kE<kI.length;kE++){if(kI[kE].length<2){continue}if(kG.length/6+kD.getVertexCount(kI[kE].length)>65536){kN.push([kG,kK]);kG=[];kK=[]}kD.buildData(kI[kE],T,kL,kG,kK,kC,e)}kN.push([kG,kK]);this._parseCacheGL[kH]=kN;this._parseCacheGL[kH].cacheIndex=kH;return kN},ifInMapView:function(){if(!this.map){return false}if(this.map.getZoom()<5){return true}if(this._config.clip===false){return true}var e=this.map.getBoundsIn();return !!e.intersects(this.getBoundsIn())},_getDisplayPixelsGLWithCut:function(e){return this._getDisplayPixelsGL(e)},_getDisplayPixelsGL:function(kC){var kE=this.map;var kD=[];var kG=[];kD.pointsArray=kG;if(kC.length==0||!this.isVisible()){return[kD]}var kF=kC;if(!this._config.enableEditing&&this._config.enableParse){kF=this._simplification(kC)}var T=[];if(!this.hasMultipleParts){T[0]=this._toOverlayPixelsGL(kF)}else{for(var e=0;e<kF.length;e++){T.push(this._toOverlayPixelsGL(kF[e]))}}return T},_toOverlayPixelsGL:function(kJ){var T=this.map;var kI=[];var kF=[];kI.pointsArray=kF;var e=T._polyOverlayBasePoint;if(this._config&&this._config.sysType==="fixed"){var e=new cG(0,0)}else{var e=T._polyOverlayBasePoint}var kH=[kJ[0].lng-e.lng,kJ[0].lat-e.lat];kI.push(kH);kF.push(kH[0],kH[1]);for(var kE=1,kD=1,kC=kJ.length;kE<kC;kE++){var kG=[kJ[kE].lng-e.lng,kJ[kE].lat-e.lat];if(kG[0]!==kI[kD-1][0]||kG[1]!==kI[kD-1][1]){kI.push(kG);kF.push(kG[0],kG[1]);kD++}}return kI},getStrokeColorForGL:function(){var i=this._config.strokeOpacity;var e;e=hW.formatColorCssToRgbaArray(this._config.strokeColor,i,false);return e},_updateDomZIndex:function(){eM.prototype._updateDomZIndex.call(this);var e=new fW("onlineupdate");e.overlay=this;e.action="zIndex";this.dispatchEvent(e)},show:function(){eM.prototype.show.call(this);var e=new fW("onlineupdate");e.action="show";e.overlay=this;this.dispatchEvent(e);if(this.map.getMapType()==="B_EARTH_MAP"||this.map._renderType==="webgl"){this._draw()}else{this.draw()}this._mouseEventPixels=null;if(this._config.enableEditing===true&&!this._config.geodesic){this.addVertexs()}if(this._areaCacheGL){var i=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[i]){this._areaCacheGL[i]=null}if(this.map._overlayMgrGL._exitOverlay(this)){this.map._overlayMgrGL._updateGraphRenderData(this,true)}}},hide:function(){eM.prototype.hide.call(this);var e=new fW("onlineupdate");e.action="hide";e.overlay=this;this.dispatchEvent(e);this._mouseEventPixels=null;if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent);this.map.removeEventListener("ondblclick",this._graphClickEvent);this.map.removeEventListener("onrightclick",this._graphClickEvent);this.map.removeEventListener("onrightdblclick",this._graphClickEvent)}eM.prototype.remove.call(this);this._clearCache();var e=new fW("onlineupdate");e.action="remove";e.overlay=this;this.fire(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},destroy:function(){this._normalizedBounds=[];this._bounds=[];this.vertexPoints=[];this._userPoints=[];this.points=[];this._mouseEventPixels=null;this._graphClickEvent=null;this._graphMouseEvent=null;if(this.domElement){this.domElement.remove()}}});e9.extend(f8.prototype,{initialize:function(i){iV.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},_getDisplayPixels:function(kO,e,kU){var kV=this.map;var kE=[];if(kO.length===0||!this.isVisible()){return[kE]}if(kV._renderType!=="webgl"&&!this.domElement){return[kE]}if(!((b5())&&kO.length>5000)&&!this._config.enableEditing&&this._config.enableParse){var kF=this.getParseCacheIndex(kV.getZoom());if(this._parseCache[kF]){kO=this._parseCache[kF]}else{var kR=this.getParseTolerance(kV.getZoom(),1);var T=d2(kO,kR);T=iY(T,kR);kO=this._parseCache[kF]=T}}var kT;var kW=kV.pointToOverlayPixelIn(kO[0],{zoom:e,center:kU});kE.push(kW);if(kW.onBack){kT=true}for(var kP=1,kM=1,kL=kO.length;kP<kL;kP++){var kD=kV.pointToOverlayPixelIn(kO[kP],{zoom:e,center:kU});if(kD.onBack){kT=true}if(!kD.equals(kE[kM-1])){kE.push(kD);kM++}}var kS=[];var kJ=Math.round(kV.offsetX);var kI=Math.round(kV.offsetY);if(kV._renderType==="webgl"){kJ=kI=0}var kH=kV.config.drawMargin;var kG={minX:-kJ-kH,minY:-kI-kH,maxX:-kJ+kH+kV.width,maxY:-kI+kH+kV.height};for(kP=0,kL=kE.length-1;kP<kL;kP++){var kQ=kE[kP];var kN=kE[kP+1];var kC=bz(kQ,kN,kG);if(kC){kS.push(kC)}}var kK=[[]];for(kP=0,kL=kS.length;kP<kL;kP++){if(kS[kP].clip){kK[kK.length-1].push(kS[kP].pixel0);kK[kK.length-1].push(kS[kP].pixel1);if(kS[kP+1]&&kS[kP+1].clip){kK.push([])}}else{kK[kK.length-1].push(kS[kP].pixel0);if(kP===kS.length-1){kK[kK.length-1].push(kS[kP].pixel1)}}}kK.isOnBack=kT;return kK},_getDisplayPixelsGLWithCut:function(kM){var kS=this.map;var kE=[];if(kM.length===0||!this.isVisible()){return[kE]}if(!this._config.enableEditing&&this._config.enableParse){var kF=this.getParseCacheIndex(kS.getZoom());if(this._parseCache[kF]){kM=this._parseCache[kF]}else{var kP=this.getParseTolerance(kS.getZoom(),1);var T=d2(kM,kP);T=iY(T,kP);kM=this._parseCache[kF]=T}}var kT=kS._polyOverlayBasePoint;var e=kS.getZoomUnits();if(this._parseCacheGLRaw[kF]){kE=this._parseCacheGLRaw[kF]}else{var kU=new fv(kM[0].lng-kT.lng,kM[0].lat-kT.lat);kE.push(kU);for(var kN=1,kK=1,kJ=kM.length;kN<kJ;kN++){var kD=new fv(kM[kN].lng-kT.lng,kM[kN].lat-kT.lat);if(!kD.equals(kE[kK-1])){kE.push(kD);kK++}}this._parseCacheGLRaw[kF]=kE}var kR=kS.pixelToPointIn(new fv(0,kS.height));var kQ=[];var kH=kS.config.drawMarginGL;var kG={minX:Math.round(-kH*e+(kR.lng-kT.lng)),minY:Math.round(-kH*e+(kR.lat-kT.lat)),maxX:Math.round((kH+kS.width)*e+(kR.lng-kT.lng)),maxY:Math.round((kH+kS.height)*e+(kR.lat-kT.lat))};for(kN=0,kJ=kE.length-1;kN<kJ;kN++){var kO=kE[kN];var kL=kE[kN+1];var kC=bz(kO,kL,kG);if(kC){kQ.push(kC)}}var kI=[[]];for(kN=0,kJ=kQ.length;kN<kJ;kN++){if(kQ[kN].clip){kI[kI.length-1].push([kQ[kN].pixel0.x,kQ[kN].pixel0.y]);kI[kI.length-1].push([kQ[kN].pixel1.x,kQ[kN].pixel1.y]);if(kQ[kN+1]&&kQ[kN+1].clip){kI.push([])}}else{kI[kI.length-1].push([kQ[kN].pixel0.x,kQ[kN].pixel0.y]);if(kN===kQ.length-1){kI[kI.length-1].push([kQ[kN].pixel1.x,kQ[kN].pixel1.y])}}}return kI},_getDisplayPixelsGL:function(kJ){var T=this.map;var kI=[];if(kJ.length===0||!this.isVisible()){return[kI]}if(this.greatCirclePoints.length>0){kJ=this.greatCirclePoints}if(!this._config.enableEditing&&this._config.enableParse){var kH=this.getParseCacheIndex(T.getZoom());if(this._parseCache[kH]){kJ=this._parseCache[kH]}else{var kG=this.getParseTolerance(T.getZoom(),1);var kK=d2(kJ,kG);kK=iY(kK,kG);kJ=this._parseCache[kH]=kK}}var e=T._polyOverlayBasePoint;kI.push([kJ[0].lng-e.lng,kJ[0].lat-e.lat]);for(var kE=1,kD=1,kC=kJ.length;kE<kC;kE++){var kF=[kJ[kE].lng-e.lng,kJ[kE].lat-e.lat];if(kF[0]!==kI[kD-1][0]||kF[1]!==kI[kD-1][1]){kI.push(kF);kD++}}kI=[kI];this._addMultipleDrawPath(kI);return kI},_addMultipleDrawPath:function(T,kE,i){if(this._config.clip===true){return}var kD=this.map;kE=kE||kD.getZoom();if(kE>12&&kD.getRenderType()!=="webgl"){return}var e=i?kD.worldSize(kE):h5.WORLD_SIZE_MC;var kC=T.slice(0);e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x-e,kH.y))}else{kG.push([kH[0]-e,kH[1]])}});T.push(kG)});e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x+e,kH.y))}else{kG.push([kH[0]+e,kH[1]])}});T.push(kG)})},getParsedPoints:function(){var kF=this.map;var i=this.points;var e=[];var T=this;var kE=i.slice(0);kE=[kE];if(this.greatCirclePoints.length>0){kE=[];kE[0]=this.greatCirclePoints}e9.each(kE,function(kH){var kG=d2(kH,T.getParseTolerance(kF.getZoom(),1));e.push(kG)});var kD=0;if(this._bounds.sw.lng<-h5.WORLD_SIZE_MC_HALF){kD=h5.WORLD_SIZE_MC}if(this._bounds.ne.lng>h5.WORLD_SIZE_MC_HALF){kD=-h5.WORLD_SIZE_MC}if(kD===0){return e}var kC=e.slice(0);e9.each(kC,function(kG){var kH=[];e9.each(kG,function(kI){kH.push(new cG(kI.lng+kD,kI.lat))});e.push(kH)});return e},_onMarkerDragging:function(kI){this._editstate=true;var T=kI.currentTarget;var kK=kI.point;var kJ=T.index;var i=this.vertexPoints;var kL;var kG=null;var kC=null;if(kJ===0){var kH=i[kJ+2].p;kL=[kK,kH];kG=new cG((kH.lng+kK.lng)/2,(kH.lat+kK.lat)/2);if(this.vertexMarkers[kJ+1]){this.vertexMarkers[kJ+1].hide()}}else{if(kJ===i.length-1){var kF=i[kJ-2].p;kL=[kF,kK];kG=new cG((kF.lng+kK.lng)/2,(kF.lat+kK.lat)/2);if(this.vertexMarkers[kJ-1]){this.vertexMarkers[kJ-1].hide()}}else{var kF=i[kJ-1].p;var kH=i[kJ+1].p;kL=[kF,kK,kH];if(!T.t){kF=i[kJ-2].p;kH=i[kJ+2].p;kL=[kF,kK,kH];kG=new cG((kF.lng+kK.lng)/2,(kF.lat+kK.lat)/2);kC=new cG((kH.lng+kK.lng)/2,(kH.lat+kK.lat)/2);if(this.vertexMarkers[kJ-1]){this.vertexMarkers[kJ-1].hide()}if(this.vertexMarkers[kJ+1]){this.vertexMarkers[kJ+1].hide()}}}}if(!this._temp.dashedLine){var kE=new f8(kL,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(kE);kE.hide();this._temp.dashedLine=kE}else{this._temp.dashedLine.setPoints(kL);this._temp.dashedLine.show()}if(this._config.nodeT&&this._config.nodeT instanceof jS){var kD=this._config.nodeT}else{var kD=new jS(E.imgPath+"nodeT.gif",new jo(11,11),{offset:new jo(5,5)})}if(!this._temp.preTNode&&kG){this._temp.preTNode=new ke(kG,{icon:kD,delFlag:true});this.map.addOverlay(this._temp.preTNode)}else{if(kG){this._temp.preTNode.setPoint(kG)}}if(!this._temp.nexTNode&&kC){this._temp.nexTNode=new ke(kC,{icon:kD,delFlag:true});this.map.addOverlay(this._temp.nexTNode)}else{if(kC){this._temp.nexTNode.setPoint(kC)}}}});e9.extend(g8.prototype,{initialize:function(i){iV.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(i){this._clearCache();this.points=iV.getGraphPoints(i).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds();this.draw();var e=new fW("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(kO,e,kT){var kU=this.map;var kE=[];if(kO.length===0||!this.isVisible()){return[kE]}if(kU._renderType!=="webgl"&&!this.domElement){return[kE]}if(!((b5())&&kO.length>5000)&&!this._config.enableEditing){var kF=this.getParseCacheIndex(kU.getZoom());if(this._parseCache[kF]){kO=this._parseCache[kF]}else{var T=d2(kO,this.getParseTolerance(kU.getZoom(),1));kO=this._parseCache[kF]=T}}var kS;var kV=kU.pointToOverlayPixelIn(kO[0],{zoom:e,center:kT});kE.push(kV);if(kV.onBack){kS=true}for(var kP=1,kM=1,kL=kO.length;kP<kL;kP++){var kD=kU.pointToOverlayPixelIn(kO[kP],{zoom:e,center:kT});if(kD.onBack){kS=true}if(!kD.equals(kE[kM-1])){kE.push(kD);kM++}}var kR=[];var kJ=Math.round(kU.offsetX);var kI=Math.round(kU.offsetY);if(kU._renderType==="webgl"){kJ=kI=0}var kH=kU.config.drawMargin;var kG={minX:-kJ-kH,minY:-kI-kH,maxX:-kJ+kH+kU.width,maxY:-kI+kH+kU.height};for(kP=0,kL=kE.length-1;kP<kL;kP++){var kQ=kE[kP];var kN=kE[kP+1];var kC=bz(kQ,kN,kG);if(kC){kR.push(kC)}}var kK=[[]];for(kP=0,kL=kR.length;kP<kL;kP++){if(kR[kP].clip){kK[kK.length-1].push(kR[kP].pixel0);kK[kK.length-1].push(kR[kP].pixel1);if(kR[kP+1]&&kR[kP+1].clip){kK.push([])}}else{kK[kK.length-1].push(kR[kP].pixel0);if(kP===kR.length-1){kK[kK.length-1].push(kR[kP].pixel1)}}}kK.isOnBack=kS;return kK},_getDisplayPixelsGLWithCut:function(kM){var kR=this.map;var kE=[];if(kM.length===0||!this.isVisible()){return[kE]}if(!this._config.enableEditing){var kF=this.getParseCacheIndex(kR.getZoom());if(this._parseCache[kF]){kM=this._parseCache[kF]}else{var T=d2(kM,this.getParseTolerance(kR.getZoom(),1));kM=this._parseCache[kF]=T}}var kS=kR._polyOverlayBasePoint;var e=kR.getZoomUnits();if(this._parseCacheGLRaw[kF]){kE=this._parseCacheGLRaw[kF]}else{var kT=new fv(kM[0].lng-kS.lng,kM[0].lat-kS.lat);kE.push(kT);for(var kN=1,kK=1,kJ=kM.length;kN<kJ;kN++){var kD=new fv(kM[kN].lng-kS.lng,kM[kN].lat-kS.lat);if(!kD.equals(kE[kK-1])){kE.push(kD);kK++}}this._parseCacheGLRaw[kF]=kE}var kQ=kR.pixelToPointIn(new fv(0,kR.height));var kP=[];var kH=kR.config.drawMarginGL;var kG={minX:Math.round(-kH*e+(kQ.lng-kS.lng)),minY:Math.round(-kH*e+(kQ.lat-kS.lat)),maxX:Math.round((kH+kR.width)*e+(kQ.lng-kS.lng)),maxY:Math.round((kH+kR.height)*e+(kQ.lat-kS.lat))};for(kN=0,kJ=kE.length-1;kN<kJ;kN++){var kO=kE[kN];var kL=kE[kN+1];var kC=bz(kO,kL,kG);if(kC){kP.push(kC)}}var kI=[[]];for(kN=0,kJ=kP.length;kN<kJ;kN++){if(kP[kN].clip){kI[kI.length-1].push([kP[kN].pixel0.x,kP[kN].pixel0.y]);kI[kI.length-1].push([kP[kN].pixel1.x,kP[kN].pixel1.y]);if(kP[kN+1]&&kP[kN+1].clip){kI.push([])}}else{kI[kI.length-1].push([kP[kN].pixel0.x,kP[kN].pixel0.y]);if(kN===kP.length-1){kI[kI.length-1].push([kP[kN].pixel1.x,kP[kN].pixel1.y])}}}return kI},_getDisplayPixelsGL:function(kI){var T=this.map;var kH=[];if(kI.length===0||!this.isVisible()){return[kH]}if(this.greatCirclePoints.length>0){kI=this.greatCirclePoints}if(!this._config.enableEditing){var kG=this.getParseCacheIndex(T.getZoom());if(this._parseCache[kG]){kI=this._parseCache[kG]}else{var kJ=d2(kI,this.getParseTolerance(T.getZoom(),1));kI=this._parseCache[kG]=kJ}}var e=T._polyOverlayBasePoint;kH.push([kI[0].lng-e.lng,kI[0].lat-e.lat]);for(var kE=1,kD=1,kC=kI.length;kE<kC;kE++){var kF=[kI[kE].lng-e.lng,kI[kE].lat-e.lat];if(kF[0]!==kH[kD-1][0]||kF[1]!==kH[kD-1][1]){kH.push(kF);kD++}}kH=[kH];this._addMultipleDrawPath(kH);return kH},_addMultipleDrawPath:function(T,kE,i){if(this._config.clip===true){return}var kD=this.map;kE=kE||kD.getZoom();if(kE>12&&kD.getRenderType()!=="webgl"){return}var e=i?kD.worldSize(kE):h5.WORLD_SIZE_MC;var kC=T.slice(0);e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x-e,kH.y))}else{kG.push([kH[0]-e,kH[1]])}});T.push(kG)});e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x+e,kH.y))}else{kG.push([kH[0]+e,kH[1]])}});T.push(kG)})},});e9.extend(cs.prototype,{initialize:function(T){iV.prototype.initialize.call(this,T);var i=this._config;var e={paths:i.path,isBuildingMask:i.isBuildingMask,isPoiMask:i.isPoiMask,isMapMask:i.isMapMask,showRegion:i.showRegion};T.stencil=T.stencil?Object.assign(T.stencil,e):e;return this.domElement},getFillStyleForGL:function(){var e=this._config.fillOpacity;var i=hW.formatColorCssToRgbaArray(this._config.fillColor,e);this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(kF){var kJ=[];var kH=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[kH]){return this._areaCacheGL[kH]}var kI=this._getDisplayPixelsGL(this.points);if(kI.pointsArray&&kI.pointsArray.length<3){this._areaCacheGL[kH]=[[],kJ];return this._areaCacheGL[kH]}var kD;var kE=[];var kC=0;for(var T=0;T<kI.length;T++){if(T>0){kC+=kI[T-1].length}kD=kF(kI[T].pointsArray,null,null,kC);for(var e=0,kG=kD.length;e<kG;e+=3){kJ.push(kD[e],kD[e+1],kD[e+2])}kE=kE.concat(kI[T].pointsArray)}var kK=[new Float32Array(kE),new Uint16Array(kJ)];this._areaCacheGL[kH]=kK;return kK}});e9.extend(ex.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);if(this._config.geodesic===true){this.calcGreatCirclePoints(jy.convertMC2LL(this.points[0][0]),jy.convertMC2LL(this.points[0][1]))}this._calcBounds()},_getDisplayPixels:function(e,kF,kC){var kE=this.map;var T=[];var i=this;var kD=e.slice(0);if(this.greatCirclePoints.length>0){kD[0]=this.greatCirclePoints}e9.each(kD,function(kH,kG){var kI=i._getEachDisplayPixels(kH,kG,kF,kC);e9.each(kI,function(kJ){T.push(kJ)})});this._addMultipleDrawPath(T,kF,true);return T},_addMultipleDrawPath:function(T,kE,i){if(this._config.clip===true){return}var kD=this.map;kE=kE||kD.getZoom();if(kE>12&&kD.getRenderType()!=="webgl"){return}var e=i?kD.worldSize(kE):h5.WORLD_SIZE_MC;var kC=T.slice(0);e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x-e,kH.y))}else{kG.push([kH[0]-e,kH[1]])}});T.push(kG)});e9.each(kC,function(kF){var kG=[];e9.each(kF,function(kH){if(kH.x){kG.push(new fv(kH.x+e,kH.y))}else{kG.push([kH[0]+e,kH[1]])}});T.push(kG)})},_getDisplayPixelsGL:function(e){var T=[];var i=this;var kC=e.slice(0);if(this.greatCirclePoints.length>0){kC[0]=this.greatCirclePoints}e9.each(kC,function(kE,kD){var kF=i._getEachDisplayPixelsGL(kE,kD);e9.each(kF,function(kG){T.push(kG)})});this._addMultipleDrawPath(T);return T},_getEachDisplayPixels:function(kM,kG,kF,kJ){var e=this.map;var kL=[];if(kM.length===0||!this.domElement||!this.isVisible()){return[kL]}kM=this._simplification(kM,kG);var kK;var kI=e.pointToOverlayPixelIn(kM[0],{zoom:kF,center:kJ});kL.push(kI);if(kI.onBack){kK=true}for(var kE=1,kC=1,T=kM.length;kE<T;kE++){var kH=e.pointToOverlayPixelIn(kM[kE],{zoom:kF,center:kJ});if(kH.onBack){kK=true}if(!kH.equals(kL[kC-1])){kL.push(kH);kC++}}if(e.getZoom()<5||this._config.clip===false){return[kL]}var kD=this._clipLine(kL);kD.isOnBack=kK;return kD},_simplification:function(T,i){if(this._config.enableEditing){return T}var kD=this.map;var kC=this.getParseCacheIndex(kD.getZoom());if(this._parseCache[kC]&&this._parseCache[kC][i]){return this._parseCache[kC][i]}else{var e=d2(T,this.getParseTolerance(kD.getZoom(),1));if(!this._parseCache[kC]){this._parseCache[kC]=[]}this._parseCache[kC][i]=e;return e}},_clipLine:function(kC){var e=this.map;var kI=[];var kL=Math.round(e.offsetX);var kK=Math.round(e.offsetY);var kM=e.config.drawMargin;var kE={minX:-kL-kM,minY:-kK-kM,maxX:-kL+kM+e.width,maxY:-kK+kM+e.height};for(var kF=0,T=kC.length-1;kF<T;kF++){var kH=kC[kF];var kG=kC[kF+1];var kJ=bz(kH,kG,kE);if(kJ){kI.push(kJ)}}var kD=[[]];for(var kF=0,T=kI.length;kF<T;kF++){if(kI[kF].clip){kD[kD.length-1].push(kI[kF].pixel0);kD[kD.length-1].push(kI[kF].pixel1);if(kI[kF+1]&&kI[kF+1].clip){kD.push([])}}else{kD[kD.length-1].push(kI[kF].pixel0);if(kF===kI.length-1){kD[kD.length-1].push(kI[kF].pixel1)}}}return kD},_getEachDisplayPixelsGL:function(kI,kF){var T=this.map;var kH=[];if(kI.length===0||!this.isVisible()){return[kH]}kI=this._simplification(kI,kF);if(this._config.clip===true){return this._clipLineGL(kI,kF)}var e=T._polyOverlayBasePoint;kH.push([kI[0].lng-e.lng,kI[0].lat-e.lat]);for(var kE=1,kD=1,kC=kI.length;kE<kC;kE++){var kG=[kI[kE].lng-e.lng,kI[kE].lat-e.lat];if(kG[0]!==kH[kD-1][0]||kG[1]!==kH[kD-1][1]){kH.push(kG);kD++}}return[kH]},_clipLineGL:function(kM,kF){var kR=this.map;var kE=this.getParseCacheIndex(kR.getZoom());var kS=kR._polyOverlayBasePoint;var kD=[];if(this._parseCacheGLRaw[kE]&&this._parseCacheGLRaw[kE][kF]){kD=this._parseCacheGLRaw[kE][kF]}else{var kT=new fv(kM[0].lng-kS.lng,kM[0].lat-kS.lat);kD.push(kT);for(var kN=1,kK=1,kJ=kM.length;kN<kJ;kN++){var kC=new fv(kM[kN].lng-kS.lng,kM[kN].lat-kS.lat);if(!kC.equals(kD[kK-1])){kD.push(kC);kK++}}if(!this._parseCacheGLRaw[kE]){this._parseCacheGLRaw[kE]=[]}this._parseCacheGLRaw[kE][kF]=kD}var e=kR.getZoomUnits();var kQ=kR.pixelToPointIn(new fv(0,kR.height));var kP=[];var kH=kR.config.drawMarginGL;var kG={minX:Math.round(-kH*e+(kQ.lng-kS.lng)),minY:Math.round(-kH*e+(kQ.lat-kS.lat)),maxX:Math.round((kH+kR.width)*e+(kQ.lng-kS.lng)),maxY:Math.round((kH+kR.height)*e+(kQ.lat-kS.lat))};for(kN=0,kJ=kD.length-1;kN<kJ;kN++){var kO=kD[kN];var kL=kD[kN+1];var T=bz(kO,kL,kG);if(T){kP.push(T)}}var kI=[[]];for(kN=0,kJ=kP.length;kN<kJ;kN++){if(kP[kN].clip){kI[kI.length-1].push([kP[kN].pixel0.x,kP[kN].pixel0.y]);kI[kI.length-1].push([kP[kN].pixel1.x,kP[kN].pixel1.y]);if(kP[kN+1]&&kP[kN+1].clip){kI.push([])}}else{kI[kI.length-1].push([kP[kN].pixel0.x,kP[kN].pixel0.y]);if(kN===kP.length-1){kI[kI.length-1].push([kP[kN].pixel1.x,kP[kN].pixel1.y])}}}return kI},getParsedPoints:function(){var kF=this.map;var i=this.points;var e=[];var T=this;var kE=i.slice(0);if(this.greatCirclePoints.length>0){kE[0]=this.greatCirclePoints}e9.each(kE,function(kH){var kG=d2(kH,T.getParseTolerance(kF.getZoom(),1));e.push(kG)});var kD=0;if(this._bounds.sw.lng<-h5.WORLD_SIZE_MC_HALF){kD=h5.WORLD_SIZE_MC}if(this._bounds.ne.lng>h5.WORLD_SIZE_MC_HALF){kD=-h5.WORLD_SIZE_MC}if(kD===0){return e}var kC=e.slice(0);e9.each(kC,function(kG){var kH=[];e9.each(kG,function(kI){kH.push(new cG(kI.lng+kD,kI.lat))});e.push(kH)});console.log(e);return e},setPointAt:function(T,e,kC){kC=kC||0;if(!e||!this.points[kC][T]||!this.points[kC][T]){return}this._clearCache();this.points[kC][T]=new cG(e.lng,e.lat);if(this._config.geodesic===true){this.calcGreatCirclePoints(jy.convertMC2LL(this.points[kC][0]),jy.convertMC2LL(this.points[kC][1]))}this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},calcGreatCirclePoints:function(kC,T){if(kC.equals(T)){return}var e=jy.getDistance(iX(kC.lng),iX(kC.lat),iX(T.lng),iX(T.lat));if(e<250000){return}this.greatCirclePoints.length=0;var kG=Math.round(e/150000);var kK=this.calcAngularDistance(kC,T);this.greatCirclePoints.push(this.points[0][0]);var kJ=kC.lng;var kI=this.points[0][0];for(var kD=0;kD<kG;kD++){var kF=this.calcMiddlePoint(kC,T,kD/kG,kK);var kH=jy.convertLL2MC(kF);var kE=kH.lng;var kL=eF(kH,kI);if(kL>30037726){if(kH.lng<kI.lng){kH.lng+=h5.WORLD_SIZE_MC}else{kH.lng-=h5.WORLD_SIZE_MC}}this.greatCirclePoints.push(kH);kI=kH}this.greatCirclePoints.push(this.points[0][1]);var kL=eF(this.points[0][1],kI);if(kL>30037726){if(this.points[0][1].lng<kI.lng){this.points[0][1].lng+=h5.WORLD_SIZE_MC}else{this.points[0][1].lng-=h5.WORLD_SIZE_MC}}},calcMiddlePoint:function(kJ,kI,kK,kO){var kD=kJ.lat;var kC=kI.lat;var kN=kJ.lng;var kL=kI.lng;var kP=iX(kD);var kM=iX(kC);var i=iX(kN);var e=iX(kL);var kR=Math.sin((1-kK)*kO)/Math.sin(kO);var kQ=Math.sin(kK*kO)/Math.sin(kO);var kG=kR*Math.cos(kP)*Math.cos(i)+kQ*Math.cos(kM)*Math.cos(e);var kF=kR*Math.cos(kP)*Math.sin(i)+kQ*Math.cos(kM)*Math.sin(e);var kE=kR*Math.sin(kP)+kQ*Math.sin(kM);var T=Math.atan2(kE,Math.sqrt(Math.pow(kG,2)+Math.pow(kF,2)));var kH=Math.atan2(kF,kG);return new cG(fl(kH),fl(T))},calcAngularDistance:function(kD,i){var kE=iX(kD.lat);var kC=iX(i.lat);var T=iX(kD.lng);var e=iX(i.lng);return Math.acos(Math.sin(kE)*Math.sin(kC)+Math.cos(kE)*Math.cos(kC)*Math.cos(Math.abs(e-T)))}});e9.extend(hB.prototype,{initialize:function(i){iV.prototype.initialize.call(this,i);var e=this._config;this.setOptions({strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,fillColor:e.fillColor,strokeOpacity:e.strokeOpacity,fillOpacity:e.fillOpacity});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new cG(e.lng,e.lat);this.points[T]=new cG(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new cG(e.lng,e.lat)}this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=jy.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},_onMarkerDragging:function(kK){this._editstate=true;var kD=kK.currentTarget;var kN=kK.point;var i=kD.inall;var kL=kD.index;var kM=kD.n;var T=this.vertexPoints;var kP;var kH=T[i-kL+2].p;var kO=kM===-1?T[T.length-2].p:T[i-kL+(this.points[kM].length)*2-2].p;var kI=null;var kC=null;var kJ=null;var kG=null;if(kL===0){kJ=T[i+2].p;kP=[kO,kN,kJ];if(!kD.t){kI=new cG((kO.lng+kN.lng)/2,(kO.lat+kN.lat)/2);kC=new cG((kJ.lng+kN.lng)/2,(kJ.lat+kN.lat)/2)}}else{if((kL%2)===0&&((kM>=0&&Math.floor(kL/2)===this.points[kM].length-1)||(kM===-1&&kL===T.length-1))){kG=T[i-2].p;kP=[kG,kN,kH];if(!kD.t){kI=new cG((kG.lng+kN.lng)/2,(kG.lat+kN.lat)/2);kC=new cG((kH.lng+kN.lng)/2,(kH.lat+kN.lat)/2)}this.vertexMarkers[i-kL].hide();this.vertexMarkers[i-kL+1].hide();this.vertexMarkers[i-1].hide()}else{kG=T[i-1].p;kJ=T[i+1].p;kP=[kG,kN,kJ];if(!kD.t){kG=T[i-2].p;kJ=T[i+2].p;kP=[kG,kN,kJ];kI=new cG((kG.lng+kN.lng)/2,(kG.lat+kN.lat)/2);kC=new cG((kJ.lng+kN.lng)/2,(kJ.lat+kN.lat)/2);if(this.vertexMarkers[i-1]){this.vertexMarkers[i-1].hide()}if(this.vertexMarkers[i+1]){this.vertexMarkers[i+1].hide()}}}}if(!this._temp.dashedLine){var kF=new f8(kP,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(kF);this._temp.dashedLine=kF}else{this._temp.dashedLine.setPoints(kP)}if(this._config.nodeT&&this._config.nodeT instanceof jS){var kE=this._config.nodeT}else{var kE=new jS(E.imgPath+"nodeT.gif",new jo(11,11),{offset:new jo(5,5)})}if(!this._temp.preTNode&&kI){this._temp.preTNode=new ke(kI,{icon:kE,delFlag:true});this.map.addOverlay(this._temp.preTNode)}else{if(kI){this._temp.preTNode.setPoint(kI)}}if(!this._temp.nexTNode&&kC){this._temp.nexTNode=new ke(kC,{icon:kE,delFlag:true});this.map.addOverlay(this._temp.nexTNode)}else{if(kC){this._temp.nexTNode.setPoint(kC)}}},getFillStyleForGL:function(){var e=this._config.fillOpacity;var i;i=hW.formatColorCssToRgbaArray(this._config.fillColor,e);this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(kF){var kJ=[];var kH=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[kH]){return this._areaCacheGL[kH]}var kI=this._getDisplayPixelsGL(this.points);if(kI.pointsArray&&kI.pointsArray.length<3){this._areaCacheGL[kH]=[[],kJ];return this._areaCacheGL[kH]}var kD;var kE=[];var kC=0;for(var T=0;T<kI.length;T++){if(T>0){kC+=kI[T-1].length}kD=kF(kI[T].pointsArray,null,null,kC);for(var e=0,kG=kD.length;e<kG;e+=3){kJ.push(kD[e],kD[e+1],kD[e+2])}kE=kE.concat(kI[T].pointsArray)}var kK=[new Float32Array(kE),new Uint16Array(kJ)];this._areaCacheGL[kH]=kK;return kK},buildFillforLineVertex:function(kH,kL){var kM=[];var kJ=this.getParseCacheIndex(this.map.getZoom());if(!kL&&this._areaCacheGL[kJ]){this._areaCacheGL[kJ].inCache=true;return this._areaCacheGL[kJ]}var kK=this._getDisplayPixelsGL(this.points);if(kK.pointsArray&&kK.pointsArray.length<3){this._areaCacheGL[kJ]=[[[],kM]];return this._areaCacheGL[kJ]}var kF;var kG=[];var kE=0;for(var kD=0;kD<kK.length;kD++){if(kD>0){kE+=kK[kD-1].length}kF=kH(kK[kD].pointsArray,null,null,kE);for(var kC=0,kI=kF.length;kC<kI;kC+=3){kM.push(kF[kC],kF[kC+1],kF[kC+2])}kG=kG.concat(kK[kD].pointsArray)}var T=[];var e=this.getLineColorForGL();for(var kD=0;kD<kG.length;kD+=2){T.push(kG[kD]*10,kG[kD+1]*10);T.push(0,0,e);T.push(0,0,0,0)}var kN=[[T,kM]];this._areaCacheGL[kJ]=kN;this._areaCacheGL[kJ].cacheIndex=kJ;this._areaCacheGL[kJ].inCache=false;kG=null;return kN},getLineColorForGL:function(){var i=this._config.fillOpacity;var kC;kC=hW.formatColorCssToRgbaArray(this._config.fillColor,i,false);var kF=new Int8Array(4);var e=new Int32Array(kF.buffer,0,1);var kE=new Float32Array(kF.buffer,0,1);function T(kG){e[0]=kG;return kE[0]}function kD(kG){var kI=(kG[3]<<24|kG[2]<<16|kG[1]<<8|kG[0]);var kH=T(kI&4278190079);return kH}return kD(kC)}});e9.extend(hg.prototype,{initialize:function(e){hB.prototype.initialize.call(this,e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return this.domElement},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=f9.getDrawer(this.map);this.domElement=e.addStandardCircle()},draw:function(i){if(!this.domElement){return}i=i||{};var T=this.getDisplayGeometry(i.center,i.zoom);if(this._drawer){this._drawer.setStandardCircleGeometry(this.domElement,T)}},getDisplayGeometry:function(e,i){var T=this.map.pointToOverlayPixelIn(this.point,{zoom:i,center:e});var kD=Math.round(this._radiusMercator/this.map.getZoomUnits(i));var kC={cx:T.x,cy:T.y,radius:kD};return kC},setPoint:function(e,T){if(!e){return}this._clearCache();if(!T){this.vertexPoints=null}this.point=e;this.latLng=jy.convertMC2LL(e);this.points=this._getPerimeterPoints(e,this.radius);this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setRadius:function(e,T){this._clearCache();if(!T){this.vertexPoints=null}this.radius=Math.abs(e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getParseTolerance:function(i,e){if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return hg.parseTolerance[e][this.getParseCacheIndex(i)]},_onMarkerDragging:function(kF){var kD;var kH;var kI;var i=this.map;this._editstate=true;var kC=kF.currentTarget;var kG=kC.index;var T=this.vertexPoints;var kE=T[0].p;var kJ=T[T.length-1].p;if(kG==0){kH=kC.point;kI=kJ}else{kH=kE;kI=kC.point}kD=jy.getDistanceByMC(kH,kI);this.setRadius(kD,true);this.setCenterIn(kH,true)},_onMarkerDragend:function(kD){this._editstate=false;var kC=kD.currentTarget;var T=kC.index;this.vertexPoints[0]={p:this.point,t:0,index:0};if(T==1){this.vertexPoints[1]={p:kC.point,t:0,index:1}}this.clearVertexs();this.addVertexs();var i=new fW("oneditend");i.pixel=kD.pixel;i.point=kD.point;i.latLng=kD.latLng;i.overlay=this;this.dispatchEvent(i)},getVertexPoints:function(){if(!this.vertexPoints&&this.points.length){var e=[];e.push({p:this.point,t:0,index:0});e.push({p:this.points[Math.floor(this.points.length*3/4)],t:0,index:1});this.vertexPoints=e}return this.vertexPoints}});e9.extend(kr.prototype,{initialize:function(i){iV.prototype.initialize.call(this,i);var e=this._config;this.setOptions({topFillColor:e.topFillColor,topFillOpacity:e.topFillOpacity,sideFillColor:e.sideFillColor,sideFillOpacity:e.sideFillOpacity,altitude:e.altitude});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new cG(e.lng,e.lat);this.points[T]=new cG(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new cG(e.lng,e.lat)}this._calcBounds();this.draw();var i=new fW("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getFillStyleForGL:function(){var T=this._config.topFillOpacity;var i=this._config.sideFillOpacity;var e;var kC;e=hW.formatColorCssToRgbaArray(this._config.topFillColor,T,false);kC=hW.formatColorCssToRgbaArray(this._config.sideFillColor,i,false);return{top:e,side:kC}},buildFillVertex:function(kE,kY){var kD=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[kD]&&!kY){return this._areaCacheGL[kD]}var k1=this._getDisplayPixelsGL(this.points);if(k1.pointsArray&&k1.pointsArray.length<3){this._areaCacheGL[kD]={vertex:[],index:[]};return this._areaCacheGL[kD]}var kW=this.getFillStyleForGL();var kP=kW.top;var kT=kW.side;var kI=this._config.altitude;var k5=[0,0,1];var kK=[];var T=[];var kV=0;for(var kZ=0;kZ<k1.length;kZ++){if(kZ>0){kV+=(k1[kZ-1].length-1)*5}var kS=k1[kZ].pointsArray;kS.splice(-2,2);var k6=this.getClockwise(kS);if(k6){kS=this.rev(kS)}for(var k2=0;k2<kS.length;k2+=2){kK.push([kS[k2],kS[k2+1],kI,k5[0],k5[1],k5[2],kP[0],kP[1],kP[2],kP[3]])}var e=kE(kS,null,null,kV);for(var k2=0,kN=e.length;k2<kN;k2+=3){T.push(e[k2],e[k2+1],e[k2+2])}for(var k2=0,kU=kS.length;k2<kU;k2+=2){var kJ=kS[k2];var kH=kS[k2+1];var kR=[kJ,kH,0];var kQ=[kJ,kH,kI];var kC=k2+2;var kG=k2+3;if(k2===kU-2){kC=0;kG=1}var k4=kS[kC];var k3=kS[kG];var kO=[k4,k3,0];var kM=[k4,k3,kI];var k0=[kO[0]-kR[0],kO[1]-kR[1],kO[2]-kR[2]];var kX=[kQ[0]-kR[0],kQ[1]-kR[1],kQ[2]-kR[2]];var k5=[];vec3.cross(k5,k0,kX);kR.push(k5[0],k5[1],k5[2]);kQ.push(k5[0],k5[1],k5[2]);kO.push(k5[0],k5[1],k5[2]);kM.push(k5[0],k5[1],k5[2]);kR.push(kT[0],kT[1],kT[2],kT[3]);kQ.push(kT[0],kT[1],kT[2],kT[3]);kO.push(kT[0],kT[1],kT[2],kT[3]);kM.push(kT[0],kT[1],kT[2],kT[3]);var kF=kK.length;kK.push(kR);kK.push(kQ);kK.push(kO);kK.push(kM);T.push(kF,kF+2,kF+3,kF,kF+3,kF+1)}}var kL={vertex:this.convertBuilding3dToTypedArray(kK),index:new Uint16Array(T)};this._areaCacheGL[kD]=kL;return kL},getClockwise:function(kI){var kE=kI.length;if(kE<6){return false}var kC=kI[kE-2];var kH=kI[kE-1];var T=kI[0];var kG=kI[1];var e=kI[2];var kF=kI[3];for(var kD=2;kD<kE;kD+=2){if(kI[kD]>T){kC=kI[kD-2];kH=kI[kD-1];T=kI[kD];kG=kI[kD+1];if(kD+2>=kE){e=kI[0];kF=kI[1]}else{e=kI[kD+2];kF=kI[kD+3]}}}return((T-kC)*(kF-kG)-(kG-kH)*(e-T)<0)},rev:function(kC){var e=[];for(var T=kC.length-1;T>=0;T-=2){e[kC.length-1-T]=kC[T-1];e[kC.length-1-T+1]=kC[T]}return e},convertBuilding3dToTypedArray:function(kF){var T=kF.length;var kC=new Float32Array(T*7);var kE=new DataView(kC.buffer);var e=0;for(var kD=0;kD<kF.length;kD++){e=kD*7;kC[e+0]=kF[kD][0];kC[e+1]=kF[kD][1];kC[e+2]=kF[kD][2];kC[e+3]=kF[kD][3];kC[e+4]=kF[kD][4];kC[e+5]=kF[kD][5];kE.setUint8(e*4+24,kF[kD][6]);kE.setUint8(e*4+25,kF[kD][7]);kE.setUint8(e*4+26,kF[kD][8]);kE.setUint8(e*4+27,kF[kD][9])}return kC}});e9.extend(b7.prototype,{initialize:function(e){iV.prototype.initialize.call(this,e);return this.domElement},getFillStyleForGL:function(){if(!this._config.url){return}switch(this._config.type){case"image":var e={type:"image",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"video":var e={type:"video",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"canvas":var e={type:"canvas",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break}return this._fillStyleInfoForGL},buildFillVertex:function(kF){var kI=[];var kH=this._getDisplayPixelsGL(this.points);var kD;var kE=[];var kC=0;for(var T=0;T<kH.length;T++){if(T>0){kC+=kH[T-1].length}kD=kF(kH[T].pointsArray,null,null,kC);for(var e=0,kG=kD.length;e<kG;e+=3){kI.push(kD[e],kD[e+1],kD[e+2])}kE=kE.concat(kH[T].pointsArray)}var kJ=[new Float32Array(kE),new Uint16Array(kI)];return kJ},buildFillMaskVertex:function(){var kH=[0,0,1,0,1,1,0,1];var kI=this._getDisplayPixelsGL(this.points);var T=this._config.maskCoord;if(this.hasMaskPng&&T&&T.length===2){var e=[];for(var kG=0;kG<T.length;kG++){e[kG]=jy.convertLL2MC(T[kG])}var kL=this._toOverlayPixelsGL(e);this.maskOverlayPixels=kL;var kF=kL[1][0]-kL[0][0];var kD=kL[1][1]-kL[0][1];var kK=(kI[0][0][0]-kL[0][0])/kF;var kJ=(kI[0][0][1]-kL[0][1])/kD;var kE=(kI[0][2][0]-kL[0][0])/kF;var kC=(kI[0][2][1]-kL[0][1])/kD;kH=[kK,kJ,kE,kJ,kE,kC,kK,kC]}else{this.maskOverlayPixels=[kI[0][0],kI[0][2]]}return kH},imageLoad:function(i,kD){var e=new Image();e.crossOrigin="anonymous";e.onload=function kC(){kD&&kD(this,true)};e.onerror=function T(){kD&&kD(null,false)};e.src=i}});function S(e){this._map=e;this._canvasAttrName={strokeweight:"lineWidth",strokecolor:"strokeStyle",fillcolor:"fillStyle",strokeopacity:"globalAlpha",fillopacity:"globalAlpha"};this._type="canvas"}S.prototype=new fe();var c2=S.prototype;c2.addLine=function(){var i=b6("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};c2.setPath=function(T,i){if(!T){return}var e=T.getContext("2d");this._setCanvasPosition(T);this._clearCanvas(e);var kD=parseInt(T.style.top);var kC=parseInt(T.style.left);e.beginPath();e9.each(i,function(kG){if(kG.length===0){return}e.moveTo(kG[0].x-kC,kG[0].y-kD);for(var kF=1,kE=kG.length;kF<kE;kF++){e.lineTo(kG[kF].x-kC,kG[kF].y-kD)}});this._drawCanvas(T)};c2.setAttribute=function(kC,i,kD){if(!kC){return}var e=kC.getContext("2d");var T=this._getAttributeName(i);if(T){e[T]=kD}kC.setAttribute("_"+i,kD||"");e.save();this._clearCanvas(e);this._drawCanvas(kC)};c2._getAttributeName=function(e){return this._canvasAttrName[e]||e};c2._setCanvasPosition=function(kD){var i=this._map;var kI=i.config.drawMargin;var T=i.width+2*kI;var kF=i.height+2*kI;var kC=-i.offsetX-kI;var kE=-i.offsetY-kI;var kH=kD.getContext("2d");var kG={strokeStyle:kH.strokeStyle,fillStyle:kH.fillStyle,globalAlpha:kH.globalAlpha,lineWidth:kH.lineWidth,lineCap:"round",lineJoin:"round"};kD.setAttribute("width",T);kD.setAttribute("height",kF);for(var e in kG){kH[e]=kG[e]}kH.save();var kJ=kD.style;kJ.top=kE+"px";kJ.left=kC+"px"};c2._clearCanvas=function(e){e.clearRect(0,0,9999,9999)};c2._drawCanvas=function(i){var e=i.getContext("2d");e.globalAlpha=i.getAttribute("_fillopacity");if(e.globalAlpha!=0&&i.getAttribute("_fillcolor")){e.fill()}e.globalAlpha=i.getAttribute("_strokeopacity");if(e.globalAlpha!==0&&i.getAttribute("_strokecolor")){e.stroke()}};c2.addStandardCircle=function(){var i=b6("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};c2.setStandardCircleGeometry=function(kC,kF){if(!kC){return}var T=kC.getContext("2d");this._setCanvasPosition(kC);this._clearCanvas(T);var kE=parseInt(kC.style.top);var kD=parseInt(kC.style.left);var i=kF.cx-kD;var kG=kF.cy-kE;var e=kF.radius;T.beginPath();T.arc(i,kG,e,0,Math.PI*2);this._drawCanvas(kC)};function fe(){}DrawerPrototype=fe.prototype;DrawerPrototype.setPalette=function(){};DrawerPrototype.addLine=function(){throw"addLineæ¥å£æ²¡æå®ç°"};DrawerPrototype.setAttribute=function(){throw"setAttributeæ¥å£æ²¡æå®ç°"};DrawerPrototype.setPath=function(){throw"setPathæ¥å£æ²¡æå®ç°"};DrawerPrototype.getType=function(){return this._type};var f9={getDrawer:function(e){if(e._renderType==="webgl"){return null}if(!f9["_"+e.hashCode]){f9["_"+e.hashCode]={}}switch(e.config.drawer){case BMAP_SVG_DRAWER:return f9.getSvgDrawer(e);case BMAP_VML_DRAWER:return f9.getVmlDrawer(e);case BMAP_CANVAS_DRAWER:return f9.getCanvasDrawer(e);default:break}if(f9.isSupportSvg()){return f9.getSvgDrawer(e)}if(f9.isSupportVml()){return f9.getVmlDrawer(e)}if(f9.isSupportCanvas()){return f9.getCanvasDrawer(e)}},getSvgDrawer:function(e){if(!f9["_"+e.hashCode]._svgDrawer){f9["_"+e.hashCode]._svgDrawer=new eX(e)}return f9["_"+e.hashCode]._svgDrawer},getVmlDrawer:function(e){if(!f9["_"+e.hashCode]._vmlDrawer){f9["_"+e.hashCode]._vmlDrawer=new ap(e)}return f9["_"+e.hashCode]._vmlDrawer},getCanvasDrawer:function(e){if(!f9["_"+e.hashCode]._canvasDrawer){f9["_"+e.hashCode]._canvasDrawer=new S(e)}return f9["_"+e.hashCode]._canvasDrawer},isSupportVml:function(){if(typeof f9.supportVml!="undefined"){return f9.supportVml}var T=document.body.appendChild(b6("div"));T.innerHTML=\'<v:shape id="vml_tester1" adj="1" />\';var i=T.firstChild;if(!i.style){return false}i.style.behavior="url(#default#VML)";var e=i?typeof i.adj=="object":true;T.parentNode.removeChild(T);f9.supportVml=e;return e},isSupportSvg:function(){if(typeof f9.supportSvg=="undefined"){f9.supportSvg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return f9.supportSvg},isSupportCanvas:function(){if(typeof f9.supportCanvas=="undefined"){f9.supportCanvas=!!b6("canvas").getContext}return f9.supportCanvas}};bG.DrawerSelector=f9;function eX(e){this._map=e;this.SVG_NS="http://www.w3.org/2000/svg";this._svgAttrName={strokeweight:"stroke-width",strokecolor:"stroke",fillcolor:"fill",strokeopacity:"stroke-opacity",fillopacity:"fill-opacity",strokestyle:"stroke-dasharray",strokelinecap:"stroke-linecap",strokelinejoin:"stroke-linejoin"};this._svg=this._createSvg();this._type="svg"}eX.prototype=new fe();var cE=eX.prototype;cE._createSvg=function(){var e=this._svg=b6("svg",{},this.SVG_NS);e.setAttribute("version","1.1");e.setAttribute("type","system");var i=e.style;i.position="absolute";i.MozUserSelect="none";this.setPalette();this._map.getPanes().mapPane.appendChild(e);return e};cE.setPalette=function(){if(!this._svg){return}var T=this._svg;var kG=this._map;var i=kG.config.drawMargin;var kD=kG.width+2*i;var e=kG.height+2*i;var kF=-kG.offsetX-i;var kE=-kG.offsetY-i;this.setAttribute(T,"x",kD+"px");this.setAttribute(T,"y",e+"px");this.setAttribute(T,"viewBox",kF+" "+kE+" "+kD+" "+e);var kC=T.style;kC.top=kE+"px";kC.left=kF+"px";kC.width=kD+"px";kC.height=e+"px"};cE.getPalette=function(){return this._svg};cE.setAttribute=function(kD,T,kE,kC,i){if(!kD){return}if(T==="strokestyle"){i=i||{};var kC=i.strokeWeight||4;var e=i.dashArray||null;switch(kE){case"dashed":if(e){kE=e.join(",")}else{kE=kC*2}break;case"dotted":if(i.strokeLineCap==="round"){kE="1,"+2*kC}else{kE=kC}break;default:kE=0;break}}var kF=kE||"none";if(kE===0){kF=0}kD.setAttributeNS(null,this._getAttributeName(T),kF);return kD};cE._getAttributeName=function(e){return this._svgAttrName[e]||e};cE.addLine=function(){var e=b6("path",{},this.SVG_NS);this.setAttribute(e,"fill-rule","evenodd");this._svg.appendChild(e);return e};cE.setPath=function(T,e){var i=this._getPathString(e)||"M -9999,-9999";this.setAttribute(T,"d",i)};cE._getPathString=function(e){if(e.length===0){return""}var i=[];e9.each(e,function(kD){if(kD.length<2){return}i.push("M "+kD[0].x+" "+kD[0].y+" L");for(var kC=1,T=kD.length;kC<T;kC++){i.push(kD[kC].x);i.push(kD[kC].y)}});return i.join(" ")};cE.addStandardCircle=function(){var e=b6("circle",{},this.SVG_NS);this._svg.appendChild(e);return e};cE.setStandardCircleGeometry=function(T,kC){var i=kC.cx;var kD=kC.cy;var e=kC.radius;this.setAttribute(T,"cx",i);this.setAttribute(T,"cy",kD);this.setAttribute(T,"r",e)};function ap(e){this._map=e;this._vmlAttrName={strokeweight:"weight",strokecolor:"color",fillcolor:"color",strokeopacity:"opacity",fillopacity:"opacity",strokestyle:"dashstyle"};this._type="vml"}ap.prototype=new fe();var dV=ap.prototype;dV.setAttribute=function(T,e,kC){if(T){if(e.indexOf("stroke")==0){T=T.getElementsByTagName("stroke")[0]}else{if(e.indexOf("fill")==0){T=T.getElementsByTagName("fill")[0]}}if(e.indexOf("color")>0){if(!kC){T.on=false}else{T.on=true}}if(e=="strokestyle"){switch(kC){case"dashed":kC="4 2 1 2";break;case"dotted":kC="1 1";break;default:kC="solid";break}}if(e=="strokeweight"){kC=kC+"px"}var i=this._getAttributeName(e);T[i]=kC||""}};dV._getAttributeName=function(e){return this._vmlAttrName[e]||e};dV.addLine=function(){var e=[\'<v:shape style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;"\',\'coordsize="1,1" coordorigin="0,0" filled="t" fillcolor="white">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:shape>"].join("");return bS(this._map.getPanes().mapPane,e)};dV.setPath=function(i,e){this.setAttribute(i,"path",this._getPathString(e));if(e9.Browser.ie==6){i.style.display="none";i.style.display=""}};dV._getPathString=function(e){if(e.length==0){return""}var i=[];e9.each(e,function(kD){if(kD.length<2){return}i.push("m "+kD[0].x+" "+kD[0].y+" l");for(var kC=1,T=kD.length;kC<T;kC++){i.push(kD[kC].x);i.push(kD[kC].y)}i.push("e")});return i.join(" ")||" "};dV.addStandardCircle=function(){var e=[\'<v:oval style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:oval>"].join("");return bS(this._map.getPanes().mapPane,e)};dV.setStandardCircleGeometry=function(T,kC){var i=kC.cx;var kD=kC.cy;var e=kC.radius;T.style.left=(i-e)+"px";T.style.top=(kD-e)+"px";T.style.width=(e*2)+"px";T.style.height=(e*2)+"px";if(e9.Browser.ie===6){T.style.display="none";T.style.display=""}};');
