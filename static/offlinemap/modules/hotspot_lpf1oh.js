/**/ï»¿_jsload&&_jsload('hotspot', 'function J(e){this._map=e;this._enableSpot=true;this.bindMapEvent()}J.prototype.enable=function(){this._enableSpot=true};J.prototype.disable=function(){this._enableSpot=false};J.prototype.bindMapEvent=function(){var kE=this._map;var kC=this;function i(){kC.disable()}function e(){kC.enable()}kE.addEventListener("movestart",i);kE.addEventListener("moveend",e);kE.addEventListener("zoomstart",i);kE.addEventListener("zoomend",function(){setTimeout(e,10)});function T(){kC.reset()}kE.addEventListener("load",T);kE.addEventListener("moveend",T);kE.addEventListener("zoomend",T);kE.addEventListener("dragend",function(){this.temp.__dragged=true});kE.addEventListener("mousemove",function kD(kO){if(kE.currentOperation!==ep.idle||kC._enableSpot===false){return}if(kO.overlay&&!(kO.overlay instanceof iV)||kO.infoWindow){return}var kT=this.temp;if(kT.spottimer){clearTimeout(kT.spottimer);kT.spottimer=null}if(kE.spotsPool){var kF=kE.temp.curSpots.slice(0);kE.temp.curSpots=[];var kP=kC.getSpotsByScreenPosition(kO.pixel);if(kP.length>0){kE.platform.style.cursor="pointer"}kE.temp.curSpotsArray=[];for(var kM=kE.temp.curSpots.length-1;kM>=0;kM--){if(kE.temp.curSpots[kM]&&kE.temp.curSpots[kM].spots&&kE.temp.curSpots[kM].spots.length>0){kE.temp.curSpotsArray=kE.temp.curSpots[kM].spots;break}}var kQ=kE.temp.curSpotsArray.slice(0);var kH=[];var kS=kM;for(var kM=kF.length-1;kM>=0;kM--){if(kM===kS){kH=kF[kS]&&kF[kS].spots||[];for(var kL=0,kJ=kH.length;kL<kJ;kL++){for(var kK=0,kG=0,kI=kE.temp.curSpotsArray.length;kK<kI;kK++,kG++){if(kH[kL]===kE.temp.curSpotsArray[kK]){kH.splice(kL,1);kL--;kQ.splice(kG,1);kG--}}}}else{if(kF[kM]&&kF[kM].spots&&kF[kM].spots.length>0){for(var kL=0;kL<kF[kM].spots.length;kL++){kH.push(kF[kM].spots[kL])}}}}if(kH.length>0){var kN=new fW("onspotmouseout");kN.spots=kH.slice(0);kE.dispatchEvent(kN)}if(kE.temp.curSpotsArray.length===0){var kR=null;if(kE.getZoom()>=17){kR=kC.checkAreaSpot(kO.point)}if(kR){if(kE.platform.style.cursor!=="pointer"){kE.platform.style.cursor="pointer"}kE.temp.curAreaSpot=kR}else{if(kE.platform.style.cursor!==kE.config.defaultCursor){kE.platform.style.cursor=kE.config.defaultCursor}kE.temp.curAreaSpot=null}}else{if(kQ.length>0){var kN=new fW("onspotmouseover");if(kE.temp.curSpots[kE.temp.curSpots.length-1].enableMultiResponse){kN.spots=kQ.slice(0)}else{kQ.sort(function(kV,kU){return kV._distance-kU._distance});kN.spots=kQ.slice(0,1)}if(kO.point){kN.point=new cG(kO.point.lng,kO.point.lat)}kN.pixel=new fv(kO.pixel.x,kO.pixel.y);kE.dispatchEvent(kN)}}}});kE.addEventListener("click",function(kL){var kJ=this.temp;if(kL.overlay&&!(kL.overlay instanceof hB)){return}if(!kL.point){return}if(b5()){kJ.curSpotsArray=kC.getSpotsByScreenPosition(kL.pixel)}var kK=new fW("onspotclick");kK.point=new cG(kL.point.lng,kL.point.lat);kK.pixel=new fv(kL.pixel.x,kL.pixel.y);if(kJ.curSpotsArray.length>0){for(var kI=0,kF=kJ.curSpots.length;kI<kF;kI++){if(kJ.curSpots[kI].spots&&kJ.curSpots[kI].spots.length>0){if(kJ.curSpots[kI].enableMultiResponse){kK.spots=kJ.curSpotsArray.slice(0)}else{kJ.curSpotsArray.sort(function(kO,kN){return kO._distance-kN._distance});kK.spots=kJ.curSpotsArray.slice(0,1)}break}}}var kH=kK.spots||[];for(var kI=0;kI<kH.length;kI++){var kG=kH[kI].pt;var kM=kC.checkAreaSpot(kG);if(kM){kJ.curAreaSpot=kM}}kK.curAreaSpot=kJ.curAreaSpot;this.dispatchEvent(kK)});kE.addEventListener("rightclick",function(kG){if(kG.overlay&&!(kG.overlay instanceof hB)){return}if(!kG.point){return}var kF=new fW("onhotspotrightclick");kF.point=new cG(kG.latlng.lng,kG.latlng.lat);kF.mct=new cG(kG.point.lng,kG.point.lat);kF.pixel=new fv(kG.pixel.x,kG.pixel.y);if(w.environment==="customEditor"){kF.styleIds=kC.checkStyleAreaSpot(kG.point)}this.dispatchEvent(kF)})};J.prototype.getSpotsByScreenPosition=function(kE){var kL=[];var e=this._map;var kG=e.getTilt();if(!e.spotsPool){return kL}for(var kC in e.spotsPool){var kJ=e.spotsPool[kC];var kH=kJ.spots.slice(0);e.temp.curSpots[kJ.zIndex]={spots:[],enableMultiResponse:kJ.enableMultiResponse};for(var kF=0,kD=kH.length;kF<kD;kF++){var kK=kH[kF];if(kK.lr&&(e.getZoom()<kK.lr[0]||e.getZoom()>kK.lr[1])){continue}var T=kK.px||e.pointToPixelIn(kK.pt);if(T.x<e.width&&T.y<e.height){if((kE.x-T.x<kK.bd[2]&&kE.x-T.x>kK.bd[0])&&(T.y-kE.y<kK.bd[3]&&T.y-kE.y>kK.bd[1])){if(kG>55){var kI=e.pointToOverlayPixelIn(kK.pt);if(kI.outOfFrustum){continue}}e.temp.curSpots[kJ.zIndex].spots.push(kK);kK._distance=cr(T,kE);kL.push(kK)}}}}return kL};J.prototype.checkAreaSpot=function(e){if(!e){return null}var T=this._map;if(T._displayOptions.indoor===false){return null}for(var kC in T.areaSpots){var i=T.areaSpots[kC];if(bT([e.lng,e.lat],i.spot)){return kC}}return null};J.prototype.checkStyleAreaSpot=function(T){if(!T){return null}var kD=this._map;var i=[];for(var kE in kD.areaSpots){var kC=kD.areaSpots[kE];var e=kC.userData;if(e.type==="mapstyle"&&bT([T.lng,T.lat],kC.spot)){i.push([e.styleId])}}return i};J.prototype.reset=function(){var e=this._map;if(e.temp.__dragged==true){e.temp.__dragged=false}else{e.temp.curSpots=[];e.platform.style.cursor=e.config.defaultCursor}};J.prototype.resetAreaSpot=function(){for(var T in this.areaSpots){var i=this.areaSpots[T];var e=i.userData;if(e.type==="mapstyle"){delete this.areaSpots[T]}}};bG.register(function(e){e._spotsMgr=new J(e)});');
